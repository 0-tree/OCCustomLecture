{\rtf1\ansi\ansicpg1252\cocoartf1504\cocoasubrtf830
{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fnil\fcharset0 HelveticaNeue;\f2\fnil\fcharset0 Verdana;
\f3\fmodern\fcharset0 Courier;\f4\fnil\fcharset0 AppleColorEmoji;\f5\fnil\fcharset0 Monaco;
\f6\fmodern\fcharset0 Courier-Oblique;}
{\colortbl;\red255\green255\blue255;\red66\green66\blue66;\red255\green255\blue255;\red0\green0\blue0;
\red83\green83\blue83;\red235\green109\blue19;\red237\green83\blue16;\red0\green0\blue0;\red241\green241\blue241;
\red124\green126\blue119;\red29\green30\blue26;\red250\green39\blue110;\red246\green246\blue239;\red224\green213\blue97;
\red224\green241\blue249;\red252\green235\blue218;\red236\green236\blue236;\red157\green101\blue255;\red126\green124\blue104;
\red88\green209\blue235;\red152\green224\blue36;\red0\green0\blue0;\red246\green198\blue207;}
{\*\expandedcolortbl;;\cssrgb\c32941\c32941\c32941;\cssrgb\c100000\c100000\c100000;\cssrgb\c0\c0\c0;
\cssrgb\c40000\c40000\c40000;\cssrgb\c94510\c50980\c8235;\cssrgb\c95294\c41569\c6275;\cssrgb\c0\c0\c0\c3922;\cssrgb\c95686\c95686\c95686;
\cssrgb\c56078\c56471\c54118;\cssrgb\c15294\c15686\c13333;\cssrgb\c99608\c26667\c50588;\cssrgb\c97255\c97255\c94902;\cssrgb\c90196\c85882\c45490;
\cssrgb\c90196\c95686\c98039;\cssrgb\c99216\c93725\c88235;\cssrgb\c94118\c94118\c94118;\cssrgb\c68235\c50588\c100000;\cssrgb\c56863\c55686\c48235;
\cssrgb\c40000\c85098\c93725;\cssrgb\c65098\c88627\c18039;\cssrgb\c0\c0\c0\c85098;\cssrgb\c97647\c82353\c84706;}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid1}
{\list\listtemplateid2\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid2}
{\list\listtemplateid3\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid3}
{\list\listtemplateid4\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid4}
{\list\listtemplateid5\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid5}
{\list\listtemplateid6\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid6}
{\list\listtemplateid7\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid7}
{\list\listtemplateid8\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid8}
{\list\listtemplateid9\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid9}
{\list\listtemplateid10\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid10}
{\list\listtemplateid11\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid1001\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid11}
{\list\listtemplateid12\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid12}
{\list\listtemplateid13\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid13}
{\list\listtemplateid14\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid14}
{\list\listtemplateid15\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid15}
{\list\listtemplateid16\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid16}
{\list\listtemplateid17\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid17}
{\list\listtemplateid18\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid18}
{\list\listtemplateid19\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid19}
{\list\listtemplateid20\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid20}
{\list\listtemplateid21\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2001\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid21}
{\list\listtemplateid22\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid22}
{\list\listtemplateid23\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid23}
{\list\listtemplateid24\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid24}
{\list\listtemplateid25\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid2401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid25}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}{\listoverride\listid2\listoverridecount0\ls2}{\listoverride\listid3\listoverridecount0\ls3}{\listoverride\listid4\listoverridecount0\ls4}{\listoverride\listid5\listoverridecount0\ls5}{\listoverride\listid6\listoverridecount0\ls6}{\listoverride\listid7\listoverridecount0\ls7}{\listoverride\listid8\listoverridecount0\ls8}{\listoverride\listid9\listoverridecount0\ls9}{\listoverride\listid10\listoverridecount0\ls10}{\listoverride\listid11\listoverridecount0\ls11}{\listoverride\listid12\listoverridecount0\ls12}{\listoverride\listid13\listoverridecount0\ls13}{\listoverride\listid14\listoverridecount0\ls14}{\listoverride\listid15\listoverridecount0\ls15}{\listoverride\listid16\listoverridecount0\ls16}{\listoverride\listid17\listoverridecount0\ls17}{\listoverride\listid18\listoverridecount0\ls18}{\listoverride\listid19\listoverridecount0\ls19}{\listoverride\listid20\listoverridecount0\ls20}{\listoverride\listid21\listoverridecount0\ls21}{\listoverride\listid22\listoverridecount0\ls22}{\listoverride\listid23\listoverridecount0\ls23}{\listoverride\listid24\listoverridecount0\ls24}{\listoverride\listid25\listoverridecount0\ls25}}
\paperw11900\paperh16840\margl1440\margr1440\vieww37240\viewh14940\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\f0\fs24 \cf0 url lecture:\
https://openclassrooms.com/courses/introduction-a-flask\
url demo code:\
https://github.com/oc-courses/concevez_un_site_avec_flask/tree/master\
\
\
\
\pard\pardeftab720\partightenfactor0

\b\fs52 \cf2 \cb3 \expnd0\expndtw0\kerning0
Tirez parti de ce cours\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b0\fs20 \cf3 \
\
\
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf3 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb5 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb6 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\partightenfactor0

\f2 \cf3 \cb3 05:36
\f1 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb6 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb5 \
\
\
\
\pard\pardeftab720\qc\partightenfactor0
\cf0 \cb1 \
\
\
\
\pard\pardeftab720\partightenfactor0
\cf3 \
\
\pard\pardeftab720\qr\partightenfactor0

\f0\fs26 \cf7 \cb3 \ul \ulc7 T\'e9l\'e9charger la vid\'e9o\cf0 \cb1 \ulnone \
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 \'a0\cb1 \
\cb3 Bienvenue dans ce cours !\cb1 \
\cb3 Ensemble, nous allons cr\'e9er une application web qui s'appelle {\field{\*\fldinst{HYPERLINK "http://le-test-ultime.hello-birds.com/"}}{\fldrslt \cf7 \ul Le test ultime}} ! H\'e9 oui, vous allez enfin d\'e9couvrir qui vous \'eates vraiment ! Avez-vous d\'e9j\'e0 cliqu\'e9 sur un lien, dans Facebook, qui vous promettait de vous dire toute la v\'e9rit\'e9 sur votre personnalit\'e9 ? Ou bien qui vous divulguerait \'e0 quel pr\'e9sentateur t\'e9l\'e9 vous ressemblez le plus ? Nous allons r\'e9aliser une application semblable ! Elle est d'ailleurs disponible {\field{\*\fldinst{HYPERLINK "http://le-test-ultime.hello-birds.com/"}}{\fldrslt \cf7 \ul \'e0 cette adresse}}.\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Le projet exemple : le test ultime !
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Imaginons un instant le parcours d'une utilisatrice, Ellen, qui souhaite effectuer le test :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls1\ilvl0\cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Une de ses amies, Estelle, a partag\'e9 le lien vers notre site sur Facebook. Une image, associ\'e9e au lien, donne la description de sa personnalit\'e9 : "Estelle - Vous \'eates une personne insaisissable, \'e9tonnante et p\'e9tillante. Rien ne vous fait peur (sauf les araign\'e9es !). Amicale et chaleureuse, vous aimez prendre un caf\'e9 en terrasse lorsque le soleil brille et raconter vos derni\'e8res p\'e9rip\'e9ties au serveur. Avez-vous envisag\'e9 une carri\'e8re d'actrice ? ;-)"\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Elle clique sur l'image et arrive sur la page d'accueil, disponible \'e0 l'adresse \'a0\'a0\'a0
\f3 \cb8 http://le-test-ultime.hello-birds.com/
\f0 \cb3 .\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Elle voit un bouton "Continuer avec Facebook". Elle clique et accepte de se connecter avec Facebook.\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
La page s'actualise pour afficher le r\'e9sultat. Notre algorithme a analys\'e9 son profil et choisi la description la plus proche de sa personnalit\'e9. Ellen\'a0voit sur la page son pr\'e9nom, sa photo et la description.\cb1 \
\ls1\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Ellen\'a0clique sur "Partager sur Facebook". Une fen\'eatre pop-up s'ouvre contenant la photo \'e0 partager et un lien vers notre site. Elle la partage \'e0 ses amis.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 {{\NeXTGraphic 14992523252814_animation.gif \width38400 \height21600 \noorient
}¨}\pard\pardeftab720\partightenfactor0
\cf0 \
\cb3 Bien ! Vous verrez, la cr\'e9ation de ce site sera tr\'e8s sympa\'a0!\cb1 \
\cb3 \'c9tant donn\'e9 que notre site g\'e9n\'e9rera du contenu automatiquement (l'image \'e0 partager sur Facebook et la description), nous ne pouvons pas cr\'e9er un site statique. Nous allons cr\'e9er un site dynamique gr\'e2ce \'e0 un des langages de programmation les plus populaires du monde : 
\b Python
\b0 .\cb1 \
\cb3 De quels outils aurons-nous besoin ?\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls2\ilvl0
\b \cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Un langage de programmation
\b0  : nous partons sur Python car c'est un langage puissant maintenu par une solide communaut\'e9 internationale.\cb1 \
\ls2\ilvl0
\b \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Une base de donn\'e9es
\b0  : il nous faut conserver les descriptions et les retrouver rapidement, c'est pourquoi nous avons besoin d'une base de donn\'e9es.\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls2\ilvl0\cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Un service qui nous permet d'
\b interagir avec la base de donn\'e9es
\b0  en Python de mani\'e8re s\'e9curis\'e9e.\cb1 \
\ls2\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Un 
\b serveur web
\b0  dont le r\'f4le va \'eatre de recevoir des requ\'eates HTTP, de les traiter et de renvoyer une r\'e9ponse HTTP conforme.\cb1 \
\ls2\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Bien d'autres \'e9l\'e9ments que nous verrons au fur et \'e0 mesure.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb9 Beaucoup de mots me sont inconnus. C'est normal ? Je dois tout arr\'eater maintenant ? :-)\cb1 \
\cb9 Ne vous inqui\'e9tez pas ! Nous verrons en d\'e9tail, dans les chapitres suivants, ce qui se cache derri\'e8re "base de donn\'e9es", "serveur web" ou "requ\'eate HTTP". Restez ! 
\f4 \uc0\u55358 \u56595 
\f0 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Nous pourrions bien entendu utiliser la puissance de Python pour cr\'e9er tous ces outils de z\'e9ro. Mais ce n'est pas n\'e9cessaire ! Plut\'f4t que de r\'e9inventer la roue, apprenons 
\b Flask
\b0 .\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Qu'est-ce que Flask ?
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Flask est un micro-framework web \'e9crit en Python. Il vous permet de concevoir une application web solide de mani\'e8re professionnelle.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb9 Qu'est-ce qu'un micro-framework web ?\cb1 \
\cb9 Il s'agit d'un ensemble de modules qui permettent de d\'e9velopper plus rapidement en fournissant des fonctionnalit\'e9s courantes. Lorsque vous concevez une application web, vous avez 
\b toujours
\b0  besoin de g\'e9rer les requ\'eates HTTP, d'un serveur web, d'afficher des pages web dynamiques, de g\'e9rer les cookies... Pourquoi coder ces fonctionnalit\'e9s \'e0 chaque fois ? 
\b Un framework web vous fournit ces fonctionnalit\'e9s pour commencer un projet sur des bases solides.
\b0 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Pourquoi Flask est-il un micro-framework ? Car, par d\'e9faut, il fait assez peu de choses. Il vous faut choisir les extensions \'e0 activer et \'e0 installer. Par exemple, il n'inclut pas la possibilit\'e9 de travailler avec une base de donn\'e9es par d\'e9faut. En effet, vous n'avez pas toujours besoin d'une base de donn\'e9es !\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://github.com/mitsuhiko"}}{\fldrslt \cf7 \cb3 \ul Armin Ronacher}}\cb3 \'a0{\field{\*\fldinst{HYPERLINK "https://github.com/pallets/flask/releases/tag/0.1"}}{\fldrslt \cf7 \ul l'a d\'e9velopp\'e9 en 2010}} dans le but de donner un cadre de travail minimal et tr\'e8s l\'e9ger pour cr\'e9er un projet rapidement.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 "Le but de Flask est de donner une bonne base de travail pour toute application. Le reste ne d\'e9pend que de vous ou d'extensions." Armin Ronacher\cb1 \
\cb3 Flask a tr\'e8s rapidement pris son essor et s'est impos\'e9 comme un des frameworks les plus importants de la communaut\'e9 Python. {\field{\*\fldinst{HYPERLINK "https://www.quora.com/What-is-LinkedIns-technology-stack"}}{\fldrslt \cf7 \ul LinkedIn}} l'utilise en interne et l'{\field{\*\fldinst{HYPERLINK "https://www.quora.com/What-is-the-technology-stack-behind-Pinterest-1"}}{\fldrslt \cf7 \ul API de Pinterest}} est bas\'e9e sur ce framework. {\field{\*\fldinst{HYPERLINK "https://www.quora.com/What-is-the-largest-site-created-using-Flask"}}{\fldrslt \cf7 \ul De nombreux autres sites}} \'e0 fort volume ont fait confiance \'e0 Flask.\cb1 \
\cb3 Pourquoi est-il si populaire ? Car il est \'e0 la fois tr\'e8s puissant et tr\'e8s l\'e9ger. Par exemple, il permet de cr\'e9er une application web minimale en 7 lignes.\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  flask \cf12 import\cf13  Flask\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 app \cf12 =\cf13  Flask(__name__)\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 @app.route(\cf14 '/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  index():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf12 return\cf13  \cf14 "Hello world !"\cf13 \
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 if\cf13  __name__ \cf12 ==\cf13  \cf14 "__main__"\cf13 :\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     app.run()\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Le code ci-dessous lance un serveur web disponible dans le port 5000. En bref, il affichera "Hello World" \'e0 l'adresse "localhost:5000". Vous ne me croyez pas ? Essayez !\cb1 \
\cb3 En bref, Flask met \'e0 disposition les \'e9l\'e9ments suivants :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls3\ilvl0\cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
gestion de cookies et sessions\cb1 \
\ls3\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
gestion des routes\cb1 \
\ls3\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
contr\'f4leur\cb1 \
\ls3\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
serveur de d\'e9veloppement\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Cela ne vous parle pas trop ? Pas d'inqui\'e9tude ! Nous verrons cela ensemble un peu plus tard.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Flask ne fournit pas, par d\'e9faut, de nombreux \'e9l\'e9ments. Contrairement \'e0 Django, qui est un autre framework web programm\'e9 en Python, il ne met pas \'e0 disposition une interface d'administration ou un ORM. Il ne permet pas non plus de cr\'e9er une structure de projet gr\'e2ce \'e0 une commande. \'c0 l'inverse, il cherche \'e0 rester le plus minimal possible. Comme disent les Anglais : less is more !\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 T\'e9l\'e9chargez notre projet exemple
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Ce cours se concentre sur l'apprentissage de Flask uniquement. Nous verrons ensemble comment ajouter un peu d'intelligence \'e0 notre application, en g\'e9n\'e9rant automatiquement des images par exemple, mais cela restera accessoire. 
\b L'essentiel est que vous compreniez Flask en codant une v\'e9ritable application !
\b0 \cb1 \
\cb3 C'est pourquoi je vous ai pr\'e9par\'e9 les \'e9l\'e9ments sur lesquels nous allons travailler. {\field{\*\fldinst{HYPERLINK "https://github.com/oc-courses/concevez_un_site_avec_flask/archive/P1C1.zip"}}{\fldrslt \cf7 \ul T\'e9l\'e9chargez le fichier en cliquant ici}}.\cb1 \
\cb3 Le dossier contient :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls4\ilvl0
\f3 \cf0 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
index.html
\f0 \cb3 \'a0: la page d'accueil du projet\cb1 \
\ls4\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
result.html
\f0 \cb3 \'a0: la page de r\'e9sultat\cb1 \
\ls4\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
static
\f0 \cb3 \'a0: feuilles de style, polices, ...\cb1 \
\ls4\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
static/css/
\f0 \cb3 \'a0: les feuilles de style\cb1 \
\ls4\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
static/fonts/
\f0 \cb3 \'a0: les polices de caract\'e8re\cb1 \
\ls4\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
static/img/
\f0 \cb3 \'a0 : images du th\'e8me\cb1 \
\ls4\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
static/js/
\f0 \cb3 \'a0: les scripts\cb1 \
\ls4\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
static/tmp
\f0 \cb3 \'a0: fichiers temporaires\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Le th\'e8me CSS utilis\'e9 est {\field{\*\fldinst{HYPERLINK "https://startbootstrap.com/template-overviews/freelancer/"}}{\fldrslt \cf7 \ul "Freelancer"}}. Il est libre de droits et se base sur Bootstrap.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb16 Si vous ouvrez les fichiers HTML, vous constaterez que vous ne pouvez pas voir le bouton "Continuer avec Facebook". C'est normal ! Il vous faut auparavant ajouter, dans le HTML, un code\'a0d'acc\'e8s fourni par Facebook.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Cr\'e9ez une application sur Facebook pour d\'e9veloppeurs
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Afin d'analyser le profil d'un utilisateur, nous\'a0avons besoin de conna\'eetre quelques informations. Nous devons pour cela lui demander de se connecter via Facebook et de nous autoriser l'acc\'e8s \'e0 ces informations. Facebook a cr\'e9\'e9 {\field{\*\fldinst{HYPERLINK "https://developers.facebook.com/products/"}}{\fldrslt \cf7 \ul de nombreux produits}} pour faciliter l'usage du r\'e9seau social par des applications tierces : Facebook Login (connexion \'e0 une application par Facebook), Facebook Share (partage sur Facebook), Facebook Analytics (analyse du comportement des utilisateurs dans notre application)... Pour pouvoir les utiliser, vous devez auparavant 
\b vous d\'e9clarer en tant que d\'e9veloppeur
\b0 .\cb1 \
\cb3 Rendez-vous {\field{\*\fldinst{HYPERLINK "https://developers.facebook.com/"}}{\fldrslt \cf7 \ul sur ce lien}} puis cliquez sur 
\f3 \cb17 Connexion
\f0 \cb3 . Connectez-vous avec votre compte Facebook professionnel.\cb1 \
\cb3 La page {\field{\*\fldinst{HYPERLINK "https://developers.facebook.com/apps/"}}{\fldrslt \cf7 \ul "Mes apps"}} liste toutes les applications que vous avez cr\'e9\'e9es. Cliquez sur 
\f3 \cb17 Ajoutez une app
\f0 \cb3 .\cb1 \
\cb3 Puis, indiquez le nom de l'application (il ne sera publi\'e9 nulle part) et une adresse e-mail de contact. Dans la page qui s'affiche, copiez les chiffres se trouvant dans le champ \'a0
\f3 \cb8 ID de l'app
\f0 \cb3 .\cb1 \
\cb3 Ouvrez le fichier\'a0
\f3 \cb8 index.html
\f0 \cb3 \'a0et remplacez les chiffres dans les emplacements suivants :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 window.fbAsyncInit = function() \{\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   FB.init(\{\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     appId      : '\{\{ your_app_id \}\}' // collez l'id ici.\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     ...\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \});\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 \};\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 (function(d, s, id) \{\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   ...\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   js.src = "https://connect.facebook.net/fr_FR/sdk.js#xfbml=1\cf18 &amp;\cf13 version=v2.9\cf18 &amp;\cf13 appId=\{\{ your_app_id \}\}"; // collez l'id ici\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 \}(document, 'script', 'facebook-jssdk'));\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Faites de m\'eame dans le fichier\'a0
\f3 \cb8 result.html
\f0 \cb3 .\cb1 \
\cb3 Revenez dans l'interface de Facebook for Developers. Cliquez sur 
\f3 \cb17 Ajouter un produit
\f0 \cb3 , s\'e9lectionnez 
\b Facebook Login
\b0  et 
\b Web SDK
\b0 . C'est tout !\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Organisation des chapitres
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Chaque chapitre commence par un rappel de l'objectif p\'e9dagogique et des notions qui seront abord\'e9es. Il termine par un rappel du code ajout\'e9. Vous pouvez consulter le code \'e0 tout moment sur le d\'e9p\'f4t GitHub {\field{\*\fldinst{HYPERLINK "https://github.com/oc-courses/concevez_un_site_avec_flask/tree/master"}}{\fldrslt \cf7 \ul accessible \'e0 cette adresse}}.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 {{\NeXTGraphic 14994434170077_Capture d‚ÄôeÃÅcran 2017-07-07 aÃÄ 18.06.11.png \width31260 \height18820 \noorient
}¨}\pard\pardeftab720\partightenfactor0
\cf0 \
\cb3 Bien, que nous manque-t-il pour d\'e9marrer ? Flask ! Allez, c'est parti pour l'installation !\
\
\
\
\
\pard\pardeftab720\partightenfactor0

\b\fs52 \cf2 Installez Flask\cb1 \
\pard\pardeftab720\partightenfactor0

\b0\fs36 \cf0 \
\pard\pardeftab720\partightenfactor0

\f1\fs20 \cf3 \
\
\
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf3 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb5 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb6 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\partightenfactor0

\f2 \cf3 \cb3 07:14
\f1 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb6 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb5 \
\
\
\
\pard\pardeftab720\qc\partightenfactor0
\cf0 \cb1 \
\
\
\
\pard\pardeftab720\partightenfactor0
\cf3 \
\
\pard\pardeftab720\qr\partightenfactor0

\f0\fs26 \cf7 \cb3 \ul T\'e9l\'e9charger la vid\'e9o\cf0 \cb1 \ulnone \
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb15 Dans ce chapitre, vous d\'e9couvrirez\'a0les notions suivantes :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls5\ilvl0\cf0 \cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Installer Flask\cb1 \
\ls5\ilvl0\cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Organiser un projet Flask\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 L'objectif de ce chapitre est de configurer notre projet avec Flask. Commen\'e7ons par l'installer !\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Installation
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Flask est un 
\b module
\b0 , son installation est donc assez standard.\cb1 \
\cb3 Commencez\'a0par cr\'e9er un environnement virtuel dans lequel\'a0vous installerez le module \'a0
\f3 \cb8 flask
\f0 \cb3 \'a0avec\'a0
\f3 \cb8 pip
\f0 \cb3 .\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 C'est du chinois ? Lisez le chapitre {\field{\*\fldinst{HYPERLINK "https://openclassrooms.com/courses/manipulez-des-donnees-avec-python-1/travaillez-dans-un-environnement-virtuel"}}{\fldrslt \cf7 \ul Travaillez dans un environnement virtuel}} du cours {\field{\*\fldinst{HYPERLINK "https://openclassrooms.com/courses/manipulez-des-donnees-avec-python-1"}}{\fldrslt \cf7 \ul Perfectionnez-vous en Python}}.\cb1 \
\cb15 La cr\'e9ation d'un environnement virtuel n'est pas obligatoire mais fortement recommand\'e9e si vous \'eates amen\'e9s \'e0 travailler sur\'a0de nombreux projets.\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 $ virtualenv env -p python3\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 $ . env/bin/activate\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 (env) $ pip install flask\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Maintenant, cr\'e9ez un fichier\'a0
\f3 \cb8 views.py
\f0 \cb3 \'a0et collez le code suivant :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  flask \cf12 import\cf13  Flask\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 app \cf12 =\cf13  Flask(__name__)\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 @app.route(\cf14 '/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  index():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf12 return\cf13  \cf14 "Hello world !"\cf13 \
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 if\cf13  __name__ \cf12 ==\cf13  \cf14 "__main__"\cf13 :\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     app.run()\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Afin de v\'e9rifier que Flask fonctionne, ex\'e9cutez le script suivant :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 $ python views.py\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Python vous informe que le serveur est lanc\'e9 ! Il attend les requ\'eates. Ouvrez un navigateur et entrez dans le champ des adresses \'a0
\f3 \cb8 http://127.0.0.1:5000/
\f0 \cb3 . Vous verrez "Hello world !" en haut \'e0 gauche de votre page. Bravo, tout fonctionne !\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Organisation du projet
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb9 Et maintenant quoi ? C'est bien beau mais ce ne serait pas plus utile d'afficher le contenu de la page\'a0
\f6\i \cb8 index.html
\f0\i0 \cb9 ?\cb1 \
\cb9 Nous y venons. Avant de faire cela, nous devons organiser notre projet un peu diff\'e9remment.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Flask, contrairement \'e0 d'autres frameworks, n'impose pas de structure. Vous pouvez tout \'e0 fait d\'e9velopper une application enti\'e8re sur un seul et m\'eame fichier. La libert\'e9, la vraie ! Mais encore une fois, ce n'est pas parce que vous pouvez le faire que vous devez le faire. Suivre certaines conventions nous sera tr\'e8s utile par la suite. Les voici :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls6\ilvl0\cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
les
\b  feuilles de style
\b0 , 
\b scripts
\b0 , 
\b images
\b0  et autres \'e9l\'e9ments qui ne seront jamais g\'e9n\'e9r\'e9s dynamiquement doivent \'eatre dans le dossier\'a0
\f3 \cb8 static
\f0 \cb3 ,\cb1 \
\ls6\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
les 
\b fichiers HTML
\b0  doivent \'eatre dans le dossier\'a0
\f3 \cb8 templates
\f0 \cb3 ,\cb1 \
\ls6\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
les 
\b tests
\b0  doivent \'eatre dans le dossier\'a0
\f3 \cb8 tests
\f0 \cb3 ,\cb1 \
\ls6\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
le fichier\'a0
\f3 \cb8 views.py
\f0 \cb3 \'a0contient les diff\'e9rentes routes de l'application (nous y reviendrons).\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Arr\'eatez le serveur et cr\'e9ez donc les dossiers suivants :\'a0
\f3 \cb8 templates
\f0 \cb3 \'a0et\'a0
\f3 \cb8 tests
\f0 \cb3 .\cb1 \
\cb3 Normalement, votre dossier de travail devrait actuellement ressembler \'e0 ceci :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 $ ls  \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 env         index.html  result.html static      templates   tests       views.py\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 C'est un peu le bazar, vous ne trouvez pas ? Je vous propose de regrouper les fichiers de notre application Facebook sous un seul et m\'eame dossier,\'a0
\f3 \cb8 fbapp
\f0 \cb3 , et de le transformer en paquet. Nous pourrons ainsi, plus tard, cr\'e9er d'autres applications qui cohabiteront ensemble.\cb1 \
\cb3 D\'e9placez tous les fichiers et dossiers (sauf, \'e9videmment, celui de votre environnement virtuel) dans\'a0
\f3 \cb8 fbapp
\f0 \cb3 .\cb1 \
\cb3 D\'e9placez\'a0
\f3 \cb8 index.html
\f0 \cb3 \'a0et\'a0
\f3 \cb8 result.html
\f0 \cb3 \'a0dans le dossier\'a0
\f3 \cb8 templates
\f0 \cb3 \'a0car l\'e0 est leur place.\cb1 \
\cb3 Puis cr\'e9ez un fichier\'a0
\f3 \cb8 __init__.py
\f0 \cb3 \'a0dans\'a0
\f3 \cb8 fbapp
\f0 \cb3 \'a0et un fichier\'a0
\f3 \cb8 run.py
\f0 \cb3 \'a0\'e0 la racine du projet. C'est ce dernier script que nous utiliserons pour lancer le projet.\cb1 \
\cb3 Ouvrez-le et ajoutez les lignes suivantes :\cb1 \
\cb3 run.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf19 #! /usr/bin/env python\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  fbapp \cf12 import\cf13  app\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 if\cf13  __name__ \cf12 ==\cf13  \cf14 "__main__"\cf13 :\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     app.run(debug\cf12 =\cf18 True\cf13 )\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb15 Vous \'eates un peu perdu\'b7e ? {\field{\*\fldinst{HYPERLINK "https://github.com/oc-courses/concevez_un_site_avec_flask/tree/P1C2"}}{\fldrslt \cf7 \ul Regardez\'a0le code final de ce chapitre}}.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Puisque nous importons\'a0
\f3 \cb8 app
\f0 \cb3 , le fichier\'a0
\f3 \cb8 __init__.py
\f0 \cb3 \'a0doit contenir cet objet. Ouvrez-le et ajoutez les lignes suivantes :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  flask \cf12 import\cf13  Flask\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  .views \cf12 import\cf13  app\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Parfait ! Si vous lancez le script\'a0
\f3 \cb8 run.py
\f0 \cb3 , vous constaterez que tout fonctionne toujours :\cb1 \
\pard\pardeftab720\partightenfactor0

\f3\fs34\fsmilli17231 \cf3 \cb4 $ python run.py\
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)\
 * Restarting with stat\
 * Debugger is active!\
 * Debugger PIN: 150-335-910\'a0\
\pard\pardeftab720\partightenfactor0

\f0\b\fs44 \cf2 \cb3 Le fichier de configuration
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Tout projet web qui grandit est amen\'e9 \'e0 travailler avec des variables que nous utiliserons un peu partout dans le projet. Par exemple, le chiffre donn\'e9 par Facebook pour identifier notre application ou l'emplacement de la base de donn\'e9es. Par convention, 
\b ces variables sont dans le\'a0fichier
\b0 \'a0
\f3 \cb8 config.py
\f0 \cb3 .\cb1 \
\cb3 Cr\'e9ons-le tout de suite ! Puis ouvrons-le pour ajouter les variables.\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf19 # To generate a new secret key:\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf19 # >>> import random, string\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf19 # >>> "".join([random.choice(string.printable) for _ in range(24)])\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 SECRET_KEY \cf12 =\cf13  \cf14 "#d#JCqTTW\cf18 \\n\cf14 ilK\cf18 \\\\\cf14 7m\cf18 \\x0b\cf14 p#\cf18 \\t\cf14 j~#H"\cf13 \
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 FB_APP_ID \cf12 =\cf13  \cf18 1200420960103822\cf13 \
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb9 Qu'est-ce que cette "SECRET_KEY" ? Est-elle obligatoire ?\cb1 \
\cb9 La "Secret Key", cl\'e9 secr\'e8te en fran\'e7ais, permet de 
\b g\'e9n\'e9rer toutes les donn\'e9es chiffr\'e9es
\b0 . Par exemple, elle permet de g\'e9n\'e9rer les cookies.\cb1 \
\cb9 Elle est donc obligatoire ! Il faut \'e9galement garder cette cl\'e9 de mani\'e8re confidentielle. Pour les besoins du cours, vous y avez acc\'e8s. Mais dans le cas d'une "vraie" application, la cl\'e9 ne doit en aucun cas \'eatre accessible par d'autres personnes. Concr\'e8tement, il s'agit simplement d'une cha\'eene de caract\'e8res al\'e9atoire qui peut \'eatre g\'e9n\'e9r\'e9e avec le code indiqu\'e9 en commentaires. Il existe \'e9galement des sites qui g\'e9n\'e8rent des cl\'e9s ({\field{\*\fldinst{HYPERLINK "http://www.miniwebtool.com/django-secret-key-generator/"}}{\fldrslt \cf7 \ul MiniWebTool}} par exemple).\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Copiez le code et collez-le dans\'a0
\f3 \cb8 config.py
\f0 \cb3 . Flask vous permet d'importer toutes les variables en une fois dans votre projet en utilisant la m\'e9thode\'a0
\f3 \cb8 config.from_object(file_name)
\f0 \cb3 . Ouvrez \'a0\'a0
\f3 \cb8 views.py
\f0 \cb3 \'a0 \'a0:\cb1 \
\cb3 views.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf19 # Config options - Make sure you created a 'config.py' file.\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 app.config.from_object(\cf14 'config'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf19 # To get one variable, tape app.config['MY_VARIABLE']\cf13 \
\pard\pardeftab720\partightenfactor0

\fs24\fsmilli12308 \cf0 \cb3 # Config options - Make sure you created a 'config.py' file.\
app.config.from_object('config')\
# To get one variable, tape app.config['MY_VARIABLE']
\f3\fs24\fsmilli12188 \cb1 \
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Bravo !\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Code de ce chapitre
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Retrouvez le code de ce chapitre {\field{\*\fldinst{HYPERLINK "https://github.com/oc-courses/concevez_un_site_avec_flask/tree/P1C2"}}{\fldrslt \cf7 \ul \'e0 cette adresse}}.\
\
\
\
\pard\pardeftab720\partightenfactor0

\b\fs52 \cf2 Ajoutez une nouvelle table dans la base de donn\'e9es\cb1 \
\pard\pardeftab720\partightenfactor0

\b0\fs36 \cf0 \cb3 \'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\fs20 \cf3 \
\
\
\
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf3 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb5 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb6 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\partightenfactor0

\f2 \cf3 \cb3 15:37
\f1 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb6 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb5 \
\
\
\
\pard\pardeftab720\qc\partightenfactor0
\cf0 \cb1 \
\
\
\
\pard\pardeftab720\partightenfactor0
\cf3 \
\pard\pardeftab720\qr\partightenfactor0

\f0\fs26 \cf7 \cb3 \ul T\'e9l\'e9charger la vid\'e9o\cf0 \cb1 \ulnone \
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb15 Dans ce chapitre vous d\'e9couvrirez\'a0les notions suivantes :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls7\ilvl0\cf0 \cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Types de base de donn\'e9es\cb1 \
\ls7\ilvl0\cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Utilisation d'un ORM\cb1 \
\ls7\ilvl0\cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Cr\'e9ation\'a0d'une base de donn\'e9es\'a0SQLite.\cb1 \
\ls7\ilvl0\cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Cr\'e9ation d'une table.\cb1 \
\ls7\ilvl0\cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Utilisation de la console de Flask\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Dans le chapitre pr\'e9c\'e9dent vous avez appris \'e0 lancer un serveur avec Flask et \'e0 configurer un projet. Avant de voir comment afficher la page\'a0
\f3 \cb8 index.html
\f0 \cb3 , cr\'e9ons une base de donn\'e9es dans laquelle nous garderons pr\'e9cieusement les diff\'e9rentes descriptions.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb9 Qu'est-ce qu'une base de donn\'e9es ? Et pourquoi ne pas commencer par l'affichage de la page\'a0
\f6\i \cb8 index.html
\f0\i0 \cb9 \'a0?\cb1 \
\cb9 Ce sont de bonnes questions ! Afin de proposer \'e0 l'utilisateur une description de sa personnalit\'e9, nous devons \'eatre en mesure de chercher des descriptions. Or, comment trouver une information qui n'est enregistr\'e9e nulle part ? Il est donc pr\'e9f\'e9rable de commencer par la cr\'e9ation de la base de donn\'e9es et des diff\'e9rents \'e9l\'e9ments qu'elle contiendra.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Mais je reviens \'e0 votre\'a0premi\'e8re question.\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Qu'est-ce qu'une base de donn\'e9es ?
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Une base de donn\'e9es est tr\'e8s similaire \'e0 un 
\b grand tableau Excel
\b0  contenant plusieurs feuilles. Nous pouvons chercher des donn\'e9es, en cr\'e9er, en modifier ou en supprimer. Les donn\'e9es sont organis\'e9es en tables, lignes et colonnes.\cb1 \
\cb3 Alors, pourquoi ne pas directement travailler sur Excel ?\cb1 \
\cb3 Excel n'a pas \'e9t\'e9 con\'e7u pour une application web : il s'agit d'un outil de gestion visuel dont le principal int\'e9r\'eat est l'interface graphique. Nous pouvons dire que les bases de donn\'e9es sont l'Excel des applications web ! \cb1 {{\NeXTGraphic clin.png \width380 \height380 \noorient
}¨}\cb3 \'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b \cf0 \cb3 Types de bases de donn\'e9es\cb1 \
\pard\pardeftab720\partightenfactor0

\b0 \cf0 \cb3 Il existe plusieurs types de bases de donn\'e9es. Plus pr\'e9cis\'e9ment, ce sont plut\'f4t des 
\b Syst\'e8mes de Gestion de Bases de Donn\'e9es (SGBD)
\b0  r\'e9partis en deux grandes familles :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls8\ilvl0
\b \cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
SGBD relationnels :
\b0  les donn\'e9es sont repr\'e9sent\'e9es dans des tableaux pouvant \'eatre li\'e9s les uns avec les autres,\cb1 \
\ls8\ilvl0
\b \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
SGBD NoSQL :
\b0  les donn\'e9es ne sont pas structur\'e9es en tableaux mais autrement : graphe, cl\'e9/valeur...\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Dans ce cours nous utiliserons 
\b SQLite
\b0 , un SGBD relationnel, mais il en existe d'autres : {\field{\*\fldinst{HYPERLINK "https://www.mysql.com/fr/"}}{\fldrslt \cf7 \ul MySQL}}, {\field{\*\fldinst{HYPERLINK "https://www.postgresql.org/"}}{\fldrslt \cf7 \ul PostgreSQL}}, {\field{\*\fldinst{HYPERLINK "https://www.oracle.com/database/index.html"}}{\fldrslt \cf7 \ul Oracle Database}}... J'ai choisi SQLite car il est libre et facile \'e0 apprendre.\cb1 \
\pard\pardeftab720\partightenfactor0

\b \cf0 \cb3 Structure d'une base dans un SGBD relationnel\cb1 \
\pard\pardeftab720\partightenfactor0

\b0 \cf0 \cb3 La base de donn\'e9es contient des tables qui elles-m\'eames contiennent des champs et des items. Si nous gardons notre comparaison avec Excel, la base de donn\'e9es serait le fichier Excel, une table serait une feuille et un champ le nom d'une colonne.\cb1 \
\cb3 Avant de cr\'e9er une table, il est important d'en conna\'eetre la structure. J'utilise l'outil {\field{\*\fldinst{HYPERLINK "http://ondras.zarovi.cz/sql/demo/"}}{\fldrslt \cf7 \ul SQL Vizualizer}}, gratuit et en ligne, pour visualiser la structure d'un projet. Voici \'e0 quoi ressemblera la base de donn\'e9es de notre projet :\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 {{\NeXTGraphic 14994445110351_Capture d‚ÄôeÃÅcran 2017-07-07 aÃÄ 18.24.31.png \width31260 \height18760 \noorient
}¨}\pard\pardeftab720\partightenfactor0
\cf0 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Cet outil se base sur {\field{\*\fldinst{HYPERLINK "https://openclassrooms.com/courses/faites-une-base-de-donnees-avec-uml"}}{\fldrslt \cf7 \ul les normes UML}}, un langage graphique permettant de mod\'e9liser la structure d'une base de donn\'e9es.\cb1 \
\pard\pardeftab720\partightenfactor0

\b \cf0 \cb3 Interroger une base\cb1 \
\pard\pardeftab720\partightenfactor0

\b0 \cf0 \cb3 Pour interagir avec un SGBD relationnel nous utilisons un langage appel\'e9 
\b SQL
\b0  (Structured Query Language). Ce langage permet d'ajouter, modifier ou supprimer des donn\'e9es mais aussi d'interroger la base selon certains crit\'e8res et faire des recoupements d'information en suivant les relations entre les tables.\cb1 \
\cb3 Une requ\'eate SQL peut ressembler \'e0 ceci :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 SELECT * FROM content\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Ceci affichera tous les items de la table\'a0
\f3 \cb8 content
\f0 \cb3 . Mais ne vous inqui\'e9tez pas : vous n'aurez pas besoin d'apprendre un nouveau langage. Nous allons utiliser Flask pour l'interroger \'e0 notre place ! \cb1 {{\NeXTGraphic smile.png \width380 \height380 \noorient
}¨}\
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Utiliser SQLite avec Flask
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Avant d'interroger une base SQLite avec Flask, vous devez installer le logiciel. Allez sur la {\field{\*\fldinst{HYPERLINK "https://sqlite.org/download.html"}}{\fldrslt \cf7 \ul page de t\'e9l\'e9chargement}} et cliquez sur le lien correspondant \'e0 votre syst\'e8me d'exploitation. Puis suivez les instructions.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Vous utilisez Linux ? Vous pouvez installer SQLite en ex\'e9cutant la commande\'a0
\f3 \cb8 sudo apt install sqlite3
\f0 \cb15 . Si vous utilisez\'a0
\f3 \cb8 brew
\f0 \cb15 , vous pouvez installer SQLite via la commande\'a0
\f3 \cb8 brew install sqlite
\f0 \cb15 .\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Cr\'e9ez un nouveau document \'e0 la racine de votre projet :\'a0
\f3 \cb8 app.db
\f0 \cb3 . Il s'agira de notre base de donn\'e9es.\cb1 \
\cb3 C'est tout ! Vous n'avez plus rien \'e0 faire. Revenons maintenant \'e0 Flask et voyons comment interroger la base de donn\'e9es.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Utiliser un ORM
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Je vous ai dit pr\'e9c\'e9demment que vous n'aviez pas besoin d'apprendre SQL car Flask int\'e9grait un outil qui le faisait\'a0pour vous. J'ai un peu enjoliv\'e9 la r\'e9alit\'e9, j'esp\'e8re que vous ne m'en voudrez pas trop !\cb1 \
\cb3 Par d\'e9faut Flask ne g\'e8re pas les bases de donn\'e9es. Vous devez installer une extension, {\field{\*\fldinst{HYPERLINK "http://www.sqlalchemy.org/"}}{\fldrslt \cf7 \ul SQLAlchemy}}, qui fera le pont entre la base de donn\'e9es et votre application.\cb1 \
\cb3 Plus sp\'e9cifiquement, vous \'e9crirez des requ\'eates en Python et {\field{\*\fldinst{HYPERLINK "http://www.sqlalchemy.org/"}}{\fldrslt \cf7 \ul SQLAlchemy}} les traduira en SQL. Puis elle vous renverra les r\'e9sultats de la requ\'eate sous la forme d'objets Python avec lesquels vous pourrez interagir.\cb1 \
\cb3 Un peu comme un traducteur automatique !\cb1 \
\cb3 C'est ce que nous appelons un 
\b ORM
\b0  (
\b Object Relational Mapping
\b0 , ou Mapping objet-relationnel en fran\'e7ais).\cb1 \
\cb3 Alors, comment utiliser SQLAlchemy ? Commencez par l'installer en utilisant pip :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 $ pip install flask_sqlalchemy\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Puis modifiez le fichier\'a0
\f3 \cb8 config.py
\f0 \cb3 \'a0en ajoutant ces lignes :\cb1 \
\cb3 config.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf12 import\cf13  os\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 basedir \cf12 =\cf13  os.path.abspath(os.path.dirname(__file__))\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 SQLALCHEMY_DATABASE_URI \cf12 =\cf13  \cf14 'sqlite:///'\cf13  \cf12 +\cf13  os.path.join(basedir, \cf14 'app.db'\cf13 )\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Cela permettra \'e0 l'ORM de savoir o\'f9 se situe notre base de donn\'e9es pour pouvoir l'interroger.\cb1 \
\cb3 Avant de connecter l'application \'e0 la base de donn\'e9es, cr\'e9ons un premier mod\'e8le.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b \cf0 \cb3 D\'e9finir un mod\'e8le\cb1 \
\pard\pardeftab720\partightenfactor0

\b0 \cf0 \cb3 Un mod\'e8le repr\'e9sente la donn\'e9e qui est stock\'e9e en base. Il\'a0indique \'e0 l'ORM
\b  la structure que vous souhaitez pour chaque table
\b0  ainsi que les associations.\cb1 \
\cb3 Vous devez \'e9galement indiquer le 
\b type de chaque champ
\b0  : est-ce un entier, une cha\'eene de caract\'e8res, un bool\'e9en ?\cb1 \
\cb3 Dans ce cours nous n'aurons besoin que d'une table (Content) qui contient trois champs :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls9\ilvl0
\f3 \cf0 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
id
\f0 \cb3 \'a0: identifiant unique de l'item. Il s'agit d'un entier et il est tr\'e8s fortement conseill\'e9 de l'indiquer pour tout nouvel item que vous cr\'e9ez.\cb1 \
\ls9\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
description
\f0 \cb3 \'a0: la description que l'utilisateur verra. Il s'agit d'une cha\'eene de 200 caract\'e8res maximum.\cb1 \
\ls9\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
gender
\f0 \cb3 \'a0: le genre de la description (f\'e9minin, masculin ou non renseign\'e9). \'c9tant donn\'e9 qu'il n'y a que trois choix possibles, nous enregistrons\'a0l'information sous la forme d'un entier.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Pour l'instant nous utilisons des entiers pour g\'e9rer le genre. Nous verrons dans le chapitre suivant comment am\'e9liorer cela.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Cr\'e9ez un nouveau fichier\'a0
\f3 \cb8 models.py
\f0 \cb3 \'a0dans le dossier\'a0
\f3 \cb8 fbapp
\f0 \cb3 . Il contiendra toutes les tables que vous souhaitez cr\'e9er ainsi que leur structure.\cb1 \
\cb3 models.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  flask_sqlalchemy \cf12 import\cf13  SQLAlchemy\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  .views \cf12 import\cf13  app\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf19 # Create database connection object\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 db \cf12 =\cf13  SQLAlchemy(app)\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 class\cf13  Content(db.Model):\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf20 id\cf13  \cf12 =\cf13  db.Column(db.Integer, primary_key\cf12 =\cf18 True\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     description \cf12 =\cf13  db.Column(db.String(\cf18 200\cf13 ), nullable\cf12 =\cf18 False\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     gender \cf12 =\cf13  db.Column(db.Integer(), nullable\cf12 =\cf18 False\cf13 )\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf12 def\cf13  __init__(self, description, gender):\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13         self.description \cf12 =\cf13  description\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13         self.gender \cf12 =\cf13  gender\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 db.create_all()\
\pard\pardeftab720\partightenfactor0

\f0\b\fs36 \cf0 \cb3 Connecter la base\cb1 \
\pard\pardeftab720\partightenfactor0

\b0 \cf0 \cb3 Maintenant, nous devons indiquer \'e0 Flask que nous utilisons une base de donn\'e9es. Modifions le fichier\'a0
\f3 \cb8 __init__.py
\f0 \cb3 \'a0:\cb1 \
\pard\pardeftab720\partightenfactor0

\f3 \cf0 \cb8 fbapp/__init__.py
\f0 \cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  flask \cf12 import\cf13  Flask\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  .views \cf12 import\cf13  app\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  . \cf12 import\cf13  models\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf19 # Connect sqlalchemy to app\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 models.db.init_app(app)\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Si vous lancez le serveur, rien ne se produit. En apparence ! Afin d'\'eatre s\'fbrs que la table Content a bien \'e9t\'e9 cr\'e9\'e9e, "entrons" dans le programme afin d'interagir directement avec la base de donn\'e9es.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 D\'e9couvrir\'a0la console Flask
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Nous pourrions utiliser PDB, le d\'e9bogueur de Python, mais je vais plut\'f4t vous montrer comment lancer la console interactive de Flask.\cb1 \
\cb3 Dans votre console, ex\'e9cutez la commande suivante :\cb1 \
\cb3 Mac OS ou Linux\cb1 \
\pard\pardeftab720\partightenfactor0

\f3\fs34\fsmilli17231 \cf3 \cb4 $ FLASK_APP=run.py flask shell\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Windows\cb1 \
\pard\pardeftab720\partightenfactor0

\f3\fs34\fsmilli17231 \cf3 \cb4 $ set FLASK_APP=run.py\
$ flask shell\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 \'a0\cb1 \
\cb3 Une console s'ouvre :\cb1 \
\pard\pardeftab720\partightenfactor0

\f3\fs34\fsmilli17231 \cf3 \cb4 Python 3.6.1 (default, Mar 23 2017, 16:49:06)\
[GCC 4.2.1 Compatible Apple LLVM 8.0.0 (clang-800.0.42.1)] on darwin\
App: fbapp.views\
Instance: /Users/celinems/sites/oc/exercices_exemples/flask_example/instance\
>>> \'a0\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Python attend vos instructions. Vous avez acc\'e8s \'e0 quelques objets, dont\'a0
\f3 \cb8 app
\f0 \cb3 \'a0:\cb1 \
\pard\pardeftab720\partightenfactor0

\f3\fs34\fsmilli17231 \cf3 \cb4 >>> app\
<Flask 'fbapp.views'>\
>>> app.config\
<Config \{'DEBUG': False, 'TESTING': False, ...\}\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Utilisons cette console pour interagir avec la base. Importez les mod\'e8les et commen\'e7ons :\cb1 \
\pard\pardeftab720\partightenfactor0

\f3\fs34\fsmilli17231 \cf3 \cb4 >>> from fbapp.models import db, Content\
>>> db.session.add(Content("What's your favorite scary movie?", 0))\
>>> db.session.commit()\
>>> Content.query.all()\
>>> [<fbapp.models.Content object at 0x1040518d0>]\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Je vais vous expliquer\'a0ce qui s'est pass\'e9\'a0!\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls10\ilvl0
\f3 \cf0 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
db.session.add()
\f0 \cb3 \'a0: Cette m\'e9thode permet d'ajouter un item \'e0 la base. En param\'e8tres, vous passez l'instance de l'objet que vous voulez cr\'e9er.\cb1 \
\ls10\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
db.session.commit()
\f0 \cb3 \'a0: Chaque cr\'e9ation est ajout\'e9e dans une session. Lorsque vous avez termin\'e9 d'ajouter des \'e9l\'e9ments, vous devez indiquer \'e0 SQLAlchemy de faire les requ\'eates dans la base pour finaliser l'op\'e9ration.\cb1 \
\ls10\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Content.query.all()
\f0 \cb3 \'a0: Cette m\'e9thode renvoie tous les items de la table Content. En r\'e9ponse, nous voyons que nous avons bien un item.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Les sessions de SQLAlchemy permettent de g\'e9rer les transactions SQL, autrement dit 
\b un ensemble de requ\'eates
\b0 . Si l'une d'elles \'e9choue, l'ensemble de la transaction est annul\'e9e et aucune requ\'eate n'est communiqu\'e9e \'e0 la base.\cb1 \
\cb3 Il s'agit d'un syst\'e8me tr\'e8s utile pour g\'e9rer des s\'e9quences d'op\'e9rations d\'e9pendantes les unes des autres. Par exemple, si nous r\'e9alisons\'a0les deux op\'e9rations suivantes :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls11\ilvl0\cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	1	}\expnd0\expndtw0\kerning0
Cr\'e9ation d'un utilisateur\cb1 \
\ls11\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	2	}\expnd0\expndtw0\kerning0
Cr\'e9ation des propri\'e9t\'e9s de cet utilisateur dans une autre table (son nom, son mot de passe...)\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Imaginons que la deuxi\'e8me requ\'eate \'e9choue. Nous nous retrouvons\'a0alors avec un utilisateur sans permission et notre base est dans un \'e9tat corrompu. Il aurait mieux fallu ne pas cr\'e9er l'utilisateur 
\b du tout
\b0  !\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Pour en savoir plus, lisez la {\field{\*\fldinst{HYPERLINK "http://docs.sqlalchemy.org/en/latest/orm/tutorial.html#adding-and-updating-objects"}}{\fldrslt \cf7 \ul documentation de SQLAlchemy}}.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Interagir avec la base via SQLAlchemy
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Nous avons vu comment ajouter des items en utilisant la m\'e9thode\'a0
\f3 \cb8 add()
\f0 \cb3 . Voyons maintenant comment modifier un item ou le supprimer. Utile, n'est-ce pas ?\cb1 \
\cb3 Avant de pouvoir modifier un item, il faut le retrouver ! Comment trouver un item ? La m\'e9thode la plus simple est de chercher via son\'a0
\f3 \cb8 id
\f0 \cb3 , identifiant unique.\cb1 \
\pard\pardeftab720\partightenfactor0

\f3\fs34\fsmilli17231 \cf3 \cb4 >>> content = Content.query.get(1)\
<fbapp.models.Content object at 0x1061d98d0>\
>>> content.description\
"What's your favorite scary movie?"\
>>> content.description = "Il s'appelle Juste Leblanc."\
>>> db.session.commit()\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Pour supprimer un \'e9l\'e9ment, utilisez\'a0
\f3 \cb8 delete(element)
\f0 \cb3 \'a0:\cb1 \
\pard\pardeftab720\partightenfactor0

\f3\fs34\fsmilli17231 \cf3 \cb4 >>> content = Content.query.get(1)\
<fbapp.models.Content object at 0x1061d98d0>\
>>> db.session.delete(content)\
>>> db.session.commit()\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb15 Pour en savoir plus, consultez le chapitre {\field{\*\fldinst{HYPERLINK "http://flask-sqlalchemy.pocoo.org/2.1/queries/"}}{\fldrslt \cf7 \ul Select, Insert, Delete}} de la documentation officielle.\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Peupler la table de donn\'e9es pr\'e9-existantes
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Nous touchons presque au but !\cb1 \
\cb3 La derni\'e8re \'e9tape, si vous l'acceptez, est d'ajouter des descriptions \'e0 la base 
\b une seule fois
\b0 . En effet, le script\'a0
\f3 \cb8 models.py
\f0 \cb3 \'a0est lanc\'e9 
\b \'e0 chaque d\'e9marrage du serveur
\b0 . Cela veut dire que le script tentera de cr\'e9er la table une seconde fois \'e0 chaque nouveau d\'e9marrage !\cb1 \
\cb3 Comment faire ?\cb1 \
\cb3 Je vous propose de lancer la cr\'e9ation en ligne de commande et non pas dans le script. Nous pourrions ainsi \'e9crire\'a0
\f3 \cb8 FLASK_APP=run.py flask init_db
\f0 \cb3 .\cb1 \
\cb3 Voici comment faire\'a0!\cb1 \
\pard\pardeftab720\partightenfactor0

\f3 \cf0 \cb8 fbapp/__init__.py
\f0 \cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 @app.cli.command()\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  init_db():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     models.init_db()\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Puis nous ajoutons la m\'e9thode dans
\f3 \cb8 models.py
\f0 \cb3 :\cb1 \
\cb3 models.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf12 import\cf13  logging \cf12 as\cf13  lg\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  init_db():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     db.drop_all()\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     db.create_all()\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     db.session.add(Content(\cf14 "THIS IS SPARTAAAAAAA!!!"\cf13 , \cf18 1\cf13 ))\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     db.session.add(Content(\cf14 "What's your favorite scary movie?"\cf13 , \cf18 0\cf13 ))\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     db.session.commit()\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     lg.warning(\cf14 'Database initialized!'\cf13 )\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 \'c0 pr\'e9sent, lan\'e7ons l'initialisation :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 $ FLASK_APP=run.py flask init_db\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 WARNING:root:Database initialized!\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 \'c7a a fonctionn\'e9 !\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Code du chapitre
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Ce chapitre occulte de nombreux aspects des bases de donn\'e9es. Afin d'aller plus loin, je vous conseille le cours {\field{\*\fldinst{HYPERLINK "https://openclassrooms.com/courses/faites-une-base-de-donnees-avec-uml"}}{\fldrslt \cf7 \ul Faites une base de donn\'e9es avec UML}}.\cb1 \
\cb3 Retrouvez le code de ce chapitre ici {\field{\*\fldinst{HYPERLINK "https://github.com/oc-courses/concevez_un_site_avec_flask/tree/P1C3"}}{\fldrslt \cf7 \ul \'e0 cette adresse}}.\
\
\
\
\pard\pardeftab720\partightenfactor0

\b\fs52 \cf2 Affichez le contenu d'un template\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b0\fs20 \cf3 \
\
\
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 \
\pard\pardeftab720\qc\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb5 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb6 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\partightenfactor0

\f2 \cf3 \cb3 06:21
\f1 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb6 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb5 \
\
\
\
\pard\pardeftab720\qc\partightenfactor0
\cf0 \cb1 \
\
\
\
\
\pard\pardeftab720\partightenfactor0
\cf3 \
\
\pard\pardeftab720\qr\partightenfactor0

\f0\fs26 \cf7 \cb3 \ul T\'e9l\'e9charger la vid\'e9o\cf0 \cb1 \ulnone \
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 \'a0\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Dans ce chapitre vous d\'e9couvrirez\'a0les notions suivantes :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls12\ilvl0\cf0 \cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
L'architecture mod\'e8le / vue / template (MVT)\cb1 \
\ls12\ilvl0\cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
L'architecture REST\cb1 \
\ls12\ilvl0\cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
La cr\'e9ation d'une route dans Flask\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Notre page d'accueil est assez vide, n'est-ce pas ? C'est le moment d'afficher le contenu d'
\f3 \cb8 index.html
\f0 \cb3 \'a0!\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Comprendre l'architecture mod\'e8le / vue / template
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 La structure d'un projet est une des cl\'e9s qui garantit sa bonne \'e9volution, exactement comme dans votre ordinateur ! Imaginez que vous repreniez le projet d'une autre personne, ou que vous ouvriez le v\'f4tre dans six mois. Vous ne voulez pas perdre de temps \'e0 chercher comment il est organis\'e9 ! Vous voulez aller droit au but et apporter votre modification sans pour autant tout casser.\cb1 \
\cb3 C'est pourquoi la plupart des frameworks pens\'e9s pour le web choisissent de 
\b s\'e9parer les fichiers dans plusieurs dossiers
\b0  distincts. Cela peut para\'eetre un peu contraignant au d\'e9but mais ce sont de bonnes pratiques qui garantissent la bonne \'e9volution de votre projet.\cb1 \
\cb3 Flask, comme vous le savez d\'e9sormais, n'impose pas vraiment de structure, il la propose. S'inspirant du 
\b mod\'e8le MVC
\b0  (Mod\'e8le / Vue / Contr\'f4leur) de bien des frameworks, il se base sur trois piliers fortement imbriqu\'e9s : 
\b le mod\'e8le, la vue et le template
\b0 . Voyons-les en d\'e9tail.\cb1 \
\pard\pardeftab720\partightenfactor0

\b \cf0 \cb3 Le Mod\'e8le\cb1 \
\pard\pardeftab720\partightenfactor0

\fs32 \cf0 \cb3 D\'e9finition\cb1 \
\pard\pardeftab720\partightenfactor0

\b0\fs36 \cf0 \cb3 Un mod\'e8le, comme nous l'avons vu dans le chapitre pr\'e9c\'e9dent, repr\'e9sente la 
\b structure de l'objet
\b0  qui sera stock\'e9 dans la base de donn\'e9es.\cb1 \
\cb3 Dans Flask, le mod\'e8le de chaque objet est repr\'e9sent\'e9 par une classe dans le fichier\'a0
\f3 \cb8 models.py
\f0 \cb3 . La classe h\'e9rite de\'a0
\f3 \cb8 db.Model
\f0 \cb3 \'a0et peut donc utiliser les m\'e9thodes de la classe parent.\cb1 \
\cb3 Deux parties sont \'e0 distinguer dans un mod\'e8le :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls13\ilvl0\cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
la structure de l'item dans la base de donn\'e9es,\cb1 \
\ls13\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
les attributs d'instance expos\'e9s.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 L'appel \'e0\'a0
\f3 \cb8 db.Column
\f0 \cb3 \'a0cr\'e9e une nouvelle colonne dans la table. Cela permet de filtrer les r\'e9sultats d'une recherche par le contenu de cette colonne, par exemple, en utilisant la m\'e9thode\'a0
\f3 \cb8 TableName.query.filter_by(column_name=filter).first()
\f0 \cb3 .\cb1 \
\cb3 La m\'e9thode\'a0
\f3 \cb8 __init__
\f0 \cb3 , elle, construit l'instance. Chaque attribut expos\'e9 \'e0 cet endroit pourra \'eatre modifi\'e9 par la suite de la m\'eame mani\'e8re que n'importe quelle instance de classe Python. Dans notre exemple, vous pouvez ainsi cr\'e9er un nouvel \'e9l\'e9ment\'a0
\f3 \cb8 content
\f0 \cb3 \'a0dans la base en sp\'e9cifiant sa description et son genre 
\b mais pas son id
\b0 .\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs32 \cf0 \cb3 Exemple\cb1 \
\pard\pardeftab720\partightenfactor0

\b0\fs36 \cf0 \cb3 Dans notre projet,\'a0
\f3 \cb8 models.py
\f0 \cb3 \'a0contient un mod\'e8le\'a0
\f3 \cb8 Content
\f0 \cb3 . Pour comprendre la diff\'e9rence entre ce qui est stock\'e9 en base et les valeurs retourn\'e9es, je vous propose d'am\'e9liorer la gestion de l'attribut\'a0
\f3 \cb8 gender
\f0 \cb3 .\cb1 \
\cb3 Pour l'instant, nous enregistrons le genre en tant qu'entier mais nous ne connaissons pas (encore) le chiffre associ\'e9 \'e0 chacun.\cb1 \
\cb3 Nous verrons plus tard que Facebook renvoie les valeurs\'a0
\f3 \cb8 male
\f0 \cb3 \'a0ou\'a0
\f3 \cb8 female
\f0 \cb3 \'a0de l'utilisateur connect\'e9. Il serait donc int\'e9ressant de pouvoir associer chaque cha\'eene de caract\'e8res \'e0 un nombre.\cb1 \
\cb3 Cr\'e9ons une nouvelle classe,\'a0
\f3 \cb8 Gender
\f0 \cb3 , qui h\'e9ritera de\'a0
\f3 \cb8 enum
\f0 \cb3 \'a0:\cb1 \
\cb3 models.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf12 import\cf13  enum\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 class\cf13  Gender(enum.Enum):\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     female \cf12 =\cf13  \cf18 0\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     male \cf12 =\cf13  \cf18 1\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     other \cf12 =\cf13  \cf18 2\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     ...\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb15 Nous avons utilis\'e9 un \'e9num\'e9rable pour g\'e9rer le genre. Pour en savoir plus, {\field{\*\fldinst{HYPERLINK "https://docs.python.org/3/library/enum.html"}}{\fldrslt \cf7 \ul lisez la documentation de Python}}.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 \'c0 pr\'e9sent, modifiez la valeur de la colonne\'a0
\f3 \cb8 gender
\f0 \cb3 \'a0et l'initialisation de la base :\cb1 \
\cb3 models.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf12 class\cf13  Content(db.Model):\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     gender \cf12 =\cf13  db.Column(db.Enum(Gender), nullable\cf12 =\cf18 False\cf13 )\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  init_db():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     db.session.add(Content(\cf14 "THIS IS SPARTAAAAAAA!!!"\cf13 , Gender[\cf14 'male'\cf13 ]))\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     db.session.add(Content(\cf14 "What's your favorite scary movie?"\cf13 , Gender[\cf14 'female'\cf13 ]))\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Cela vous\'a0permet de cr\'e9er des instances de cette mani\'e8re :\'a0
\f3 \cb8 Content('Personne ne te faisait piti\'e9, ni sur le moment, ni apr\'e8s, on \'e9tait absolument sans d\'e9fense devant toi.', Gender['male'])
\f0 \cb3 .\cb1 \
\cb3 Vous pourrez\'a0ensuite les retrouver de la mani\'e8re suivante : \'a0\'a0
\f3 \cb8 Content.query.filter_by(gender=Gender['male'])
\f0 \cb1 \
\pard\pardeftab720\partightenfactor0

\b \cf0 \cb3 Le template\cb1 \
\pard\pardeftab720\partightenfactor0

\b0 \cf0 \cb3 Un template est un fichier HTML qui peut recevoir des objets Python et qui est li\'e9 \'e0 une vue (nous y reviendrons). Il est plac\'e9 dans le dossier\'a0
\f3 \cb8 templates
\f0 \cb3 .\cb1 \
\cb3 Concr\'e8tement, un template peut interpr\'e9ter des variables et les afficher. Par exemple, nous pouvons "donner" la variable\'a0
\f3 \cb8 tom="Tom"
\f0 \cb3 \'a0au template\'a0
\f3 \cb8 index.html
\f0 \cb3 \'a0et ce dernier l'affichera \'e0 la place du pr\'e9nom.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Le template n'a acc\'e8s qu'aux variables que la vue lui transmet, et pas aux autres. Par exemple, le template n'a pas acc\'e8s \'e0 la variable\'a0
\f3 \cb8 db
\f0 \cb15 .\cb1 \
\pard\pardeftab720\partightenfactor0

\b \cf0 \cb3 La vue\cb1 \
\pard\pardeftab720\partightenfactor0

\fs32 \cf0 \cb3 Un r\'f4le essentiel\cb1 \
\pard\pardeftab720\partightenfactor0

\b0\fs36 \cf0 \cb3 Les vues contenues dans le fichier\'a0
\f3 \cb8 views.py
\f0 \cb3 \'a0jouent un r\'f4le primordial\'a0: elles d\'e9cident du contenu \'e0 afficher sur une page. Plus sp\'e9cifiquement, ce sont elles qui 
\b g\'e9n\'e8rent le contenu \'e0 renvoyer
\b0  aux requ\'eates qui leur sont adress\'e9es.\cb1 \
\cb3 Une 
\b vue
\b0 \'a0est une fonction qui renvoie une r\'e9ponse \'e0 une requ\'eate HTTP. Toute fonction d\'e9cor\'e9e par\'a0
\f3 \cb8 @app.route
\f0 \cb3 \'a0est une vue.\cb1 \
\cb3 On appelle 
\b route
\b0  l'URL \'e0 laquelle va r\'e9pondre la vue. Par exemple :\'a0
\f3 \cb8 /index
\f0 \cb3 .\cb1 \
\cb3 Afin de bien comprendre le r\'f4le majeur des vues, int\'e9ressons-nous au cheminement d'une requ\'eate.\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls14\ilvl0\cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
L'utilisateur tape\'a0
\f3 \cb8 http://le-test-ultime.hello-birds.com
\f0 \cb3 \'a0dans son navigateur puis appuie sur entr\'e9e. Cela 
\b g\'e9n\'e8re une requ\'eate HTTP
\b0  de cette forme :\cb1 \
\pard\pardeftab720\partightenfactor0

\f3\fs34\fsmilli17231 \cf3 \cb4 GET/HTTP/1.1\
Host:le-test-ultime.hello-birds.com\
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls15\ilvl0
\f0\fs36 \cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Le serveur \'e0 l'adresse\'a0
\f3 \cb8 le-test-ultime.hello-birds.com
\f0 \cb3 \'a0
\b re\'e7oit la requ\'eate
\b0  HTTP. Il cherche dans les 
\b vues
\b0  la route correspondant \'e0 la requ\'eate en fonction de la m\'e9thode HTTP utilis\'e9e et de l'URL.\cb1 \
\ls15\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Le serveur 
\b ex\'e9cute la vue
\b0  : \'e9ventuellement, si la route contient des param\'e8tres, ils sont pass\'e9s comme arguments \'e0 la vue. Si une modification d'un objet en base de donn\'e9es est demand\'e9e, la vue fait appel au mod\'e8le. Si un template est demand\'e9, la vue l'appelle.\cb1 \
\ls15\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Le serveur 
\b transmet la r\'e9ponse HTTP
\b0  de la vue au navigateur de l'utilisateur (appel\'e9 commun\'e9ment 
\b client
\b0 ).\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Le protocole HTTP est tr\'e8s int\'e9ressant ! Tout le web que nous connaissons l'utilise. Afin d'aller plus loin, je vous invite fortement \'e0 lire la partie {\field{\*\fldinst{HYPERLINK "https://openclassrooms.com/courses/construisez-une-api-rest-avec-symfony/une-architecture-pas-un-protocole#/id/r-4280629"}}{\fldrslt \cf7 \ul Une architecture bas\'e9e sur un protocole que l'on conna\'eet bien : HTTP}} du cours de Sarah Khalil.\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs32 \cf0 \cb3 Exemple\cb1 \
\pard\pardeftab720\partightenfactor0

\b0\fs36 \cf0 \cb3 Afin de mettre en pratique ce que nous venons d'explorer, affichons le contenu du template\'a0
\f3 \cb8 index.html
\f0 \cb3 \'a0lorsque l'utilisateur arrive sur la page d'accueil.\cb1 \
\cb3 views.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  flask \cf12 import\cf13  Flask, render_template\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 @app.route(\cf14 '/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  index():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf12 return\cf13  render_template(\cf14 'index.html'\cf13 )\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb15 Vous pouvez lier associer une vue \'e0 plusieurs URL\'a0! Il vous suffit de les indiquer les unes \'e0 la suite des autres :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13   @app.route(\cf14 '/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   @app.route(\cf14 '/index/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf12 def\cf13  index():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13       \cf12 return\cf13  render_template(\cf14 'index.html'\cf13 )\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb15 \'a0\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb9 Pourquoi ajouter un slash \'e0 la fin de l'URL ?\cb1 \
\cb9 Les utilisateurs peuvent taper deux adresses diff\'e9rentes \'a0
\f3 \cb8 /index
\f0 \cb9 \'a0ou \'a0
\f3 \cb8 /index/
\f0 \cb9 . H\'e9 oui, ce ne sont pas les m\'eames ! Si vous d\'e9clarez une route sans le slash final (
\f3 \cb8 /index
\f0 \cb9 ), le serveur renverra une erreur 404 (page non trouv\'e9e) si l'utilisateur tape \'a0
\f3 \cb8 /index/
\f0 \cb9 \'a0. Mais si vous d\'e9clarez une route avec le slash final (
\f3 \cb8 /index/)
\f0 \cb9 \'a0et que l'utilisateur tape \'a0
\f3 \cb8 /index
\f0 \cb9 \'a0, le serveur ne renverra pas d'erreur. Pensez-y ! \cb1 {{\NeXTGraphic smile.png \width380 \height380 \noorient
}¨}\
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Le nom de vos routes doit \'eatre parlant ! Vous et l'utilisateur devez \'eatre en mesure de comprendre, en lisant l'URL, l'action qui sera effectu\'e9e. Par exemple, \'e9vitez d'utiliser une route qui aurait cette structure :\'a0
\f3 \cb8 /mise_a_jour_description_1
\f0 \cb3 \'a0. Pr\'e9f\'e9rez l'url suivante :\'a0
\f3 \cb8 /contents/1/update
\f0 \cb3 .\cb1 \
\cb3 Il s'agit d'ailleurs d'une des bonnes pratiques les plus importantes \'e0 respecter lorsque l'on cr\'e9e une application web : l'interface uniforme de l'architecture REST.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 REST : d\'e9nominations conseill\'e9es des routes
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 REST est un acronyme pour 
\b Re
\b0 presentational 
\b S
\b0 tate 
\b T
\b0 ransfer. Cette architecture impose six contraintes que vous pouvez choisir de respecter :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls16\ilvl0
\b \cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
S\'e9paration client / serveur
\b0 \cb1 \
\ls16\ilvl0
\b \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Stateless
\b0  (sans \'e9tat)\cb1 \
\ls16\ilvl0
\b \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Cacheable
\b0  (cachable)\cb1 \
\ls16\ilvl0
\b \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Layered system
\b0  (syst\'e8me \'e0 plusieurs couches)\cb1 \
\ls16\ilvl0
\b \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Uniform interface
\b0  (interface uniforme)\cb1 \
\ls16\ilvl0
\b \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Code on demand
\b0 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Comment appliquer REST dans un projet Flask ? La question demanderait un cours entier ! Int\'e9ressez-vous en premier\'a0\'e0 l'interface uniforme et prenez le temps de bien comprendre comment cr\'e9er de bonnes URL.\cb1 \
\cb3 Prenez le temps de lire le chapitre {\field{\*\fldinst{HYPERLINK "https://openclassrooms.com/courses/construisez-une-api-rest-avec-symfony/une-architecture-pas-un-protocole"}}{\fldrslt \cf7 \ul Une architecture, pas un protocole}} du cours {\field{\*\fldinst{HYPERLINK "https://openclassrooms.com/courses/construisez-une-api-rest-avec-symfony"}}{\fldrslt \cf7 \ul Construisez une API REST avec Symphony}} de Sarah Khalil.\cb1 \
\cb3 Je vous retrouve au chapitre suivant pour am\'e9liorer le\'a0template !\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Code du chapitre
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Retrouvez le code de ce chapitre {\field{\*\fldinst{HYPERLINK "https://github.com/oc-courses/concevez_un_site_avec_flask/tree/P1C4"}}{\fldrslt \cf7 \ul \'e0 cette adresse}}\cf7 \ul .\
\
\
\
\pard\pardeftab720\partightenfactor0

\b\fs52 \cf2 \ulnone D\'e9coupez votre projet en templates\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b0\fs20 \cf3 \
\
\
\
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf3 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb5 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb6 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\partightenfactor0

\f2 \cf3 \cb3 14:26
\f1 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb6 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb5 \
\
\
\
\pard\pardeftab720\qc\partightenfactor0
\cf0 \cb1 \
\
\
\
\pard\pardeftab720\partightenfactor0
\cf3 \
\pard\pardeftab720\qr\partightenfactor0

\f0\fs26 \cf7 \cb3 \ul T\'e9l\'e9charger la vid\'e9o\cf0 \cb1 \ulnone \
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 \'a0\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Dans ce chapitre, vous d\'e9couvrirez les notions suivantes :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls17\ilvl0
\b \cf0 \cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Jinja
\b0  et le syst\'e8me de templates.\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls17\ilvl0\cf0 \cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Interaction entre un template et une vue.\cb1 \
\ls17\ilvl0\cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Organisation efficace des templates.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Flask utilise le moteur de templates {\field{\*\fldinst{HYPERLINK "http://flask.pocoo.org/docs/0.12/templating/"}}{\fldrslt \cf7 \ul Jinja 2}} par d\'e9faut. Ce dernier nous permet d'utiliser certaines m\'e9thodes dans les templates pour nous simplifier la vie : lien vers d'autres pages, import d'autres templates... Nous allons voir tout cela en d\'e9tail dans ce chapitre.\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Utiliser une m\'e9thode dans le template
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Nous avons r\'e9ussi \'e0 afficher le template\'a0
\f3 \cb8 index.html
\f0 \cb3 \'a0ainsi que les feuilles de style. Mais nous pourrions faire mieux ! Le template n'est pas qu'un fichier HTML classique car vous avez acc\'e8s \'e0 de nombreux objets qui vous faciliteront la vie.\cb1 \
\cb3 Flask offre, par exemple, une m\'e9thode plut\'f4t int\'e9ressante pour faire appel \'e0 des fichiers qui se trouvent dans le dossier\'a0static\'a0:\'a0
\f3 \cb8 url_for()
\f0 \cb3 . Cette m\'e9thode est disponible dans le template.\'a0\cb1 \
\cb3 Que fait-elle ? Elle 
\b g\'e9n\'e8re une URL
\b0 \'a0en fonction des param\'e8tres transmis.\cb1 \
\cb3 Le premier param\'e8tre est le nom du dossier qui contient les fichiers que l'on souhaite lier. Le second, optionnel, est le nom d'un fichier. Par exemple :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 url_for(\cf14 'static'\cf13 , filename\cf12 =\cf14 'css/bootstrap/bootstrap.min.css'\cf13 )\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Ceci g\'e9n\'e9rera le lien suivant : \'a0
\f3 \cb8 /static/css/bootstrap/bootstrap.min.css
\f0 \cb3 .\cb1 \
\cb3 Int\'e9grez-la dans\'a0
\f3 \cb8 index.html
\f0 \cb3 \'a0! Mais si vous vous\'a0contentez d'ins\'e9rer la m\'e9thode telle quelle dans le template, elle sera interpr\'e9t\'e9e comme du HTML pur.\cb1 \
\cb3 Afin d'indiquer \'e0 Jinja 2 que vous\'a0ins\'e9rez du Python, qui doit donc \'eatre interpr\'e9t\'e9 comme tel, entourez le code d'accolades. Comme ceci :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf3 <\cf12 div\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 \{\{ url_for('static', filename='css/bootstrap/bootstrap.min.css') \}\} \cf19 <!-- La phrase sera affich\'e9e dans la page -->\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 \{% if blur: %\}Je ne m'affiche que si "blur" est vrai.\{% endif %\}\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 \{# ceci est un commentaire #\}\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf3 </\cf12 div\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Remplacez tous les liens de la page ! Oui je sais, il y en a beaucoup... \cb1 {{\NeXTGraphic pleure.png \width380 \height380 \noorient
}¨}\
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Objets disponibles dans le template
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 La m\'e9thode\'a0
\f3 \cb8 url_for()
\f0 \cb3 \'a0fait partie des objets disponibles dans le template. Voici les autres :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls18\ilvl0
\f3 \cf0 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
config
\f0 \cb3 \'a0: dictionnaire comprenant la configuration de l'application (dans notre cas, les \'e9l\'e9ments qui se trouvent dans\'a0
\f3 \cb8 config.py
\f0 \cb3 ).\cb1 \
\ls18\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
request
\f0 \cb3 \'a0: les d\'e9tails de la requ\'eate re\'e7ue.\cb1 \
\ls18\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
session
\f0 \cb3 \'a0: la session actuelle. Vous pouvez en effet stocker des valeurs dans la session pour la retrouver ult\'e9rieurement. Il s'agit d'une pratique tr\'e8s courante pour authentifier un utilisateur et se souvenir de son passage.\cb1 \
\ls18\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
g
\f0 \cb3 \'a0: variables globales.\'a0\cb1 \
\ls18\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
get_flashed_messages()
\f0 \cb3 \'a0: messages flash. Nous n'entrerons pas dans le d\'e9tail de cette m\'e9thode mais je vous invite \'e0 {\field{\*\fldinst{HYPERLINK "http://flask.pocoo.org/docs/0.12/templating/#standard-context"}}{\fldrslt \cf7 \ul lire la documentation}} pour en savoir plus.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Je vous propose d'utiliser la variable\'a0
\f3 \cb8 config
\f0 \cb3 \'a0pour afficher le contenu de la variable\'a0
\f3 \cb8 FB_APP_ID
\f0 \cb3 \'a0de\'a0
\f3 \cb8 config.py
\f0 \cb3 \'a0:\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf20 window\cf3 .\cf21 fbAsyncInit\cf13  \cf12 =\cf13  \cf20 function\cf13 () \{\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   FB\cf3 .\cf13 init(\{\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     appId      \cf3 :\cf13  \cf14 '\{\{ config['\cf13 FB_APP_ID\cf14 '] \}\}'\cf3 ,\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     cookie     \cf3 :\cf13  \cf18 true\cf3 ,\cf13   \cf19 // enable cookies to allow the server to access\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13                         \cf19 // the session\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     xfbml      \cf3 :\cf13  \cf18 true\cf3 ,\cf13   \cf19 // parse social plugins on this page\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     version    \cf3 :\cf13  \cf14 'v2.8'\cf13  \cf19 // use graph api version 2.8\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \})\cf3 ;\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 \}  \
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf12 ...\cf13 \
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   (\cf20 function\cf13 (d\cf3 ,\cf13  s\cf3 ,\cf13  id) \{\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf20 var\cf13  js\cf3 ,\cf13  fjs \cf12 =\cf13  d\cf3 .\cf20 getElementsByTagName\cf13 (s)[\cf18 0\cf13 ]\cf3 ;\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf12 if\cf13  (d\cf3 .\cf20 getElementById\cf13 (id)) \cf12 return\cf3 ;\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   js \cf12 =\cf13  d\cf3 .\cf20 createElement\cf13 (s)\cf3 ;\cf13  js\cf3 .\cf13 id \cf12 =\cf13  id\cf3 ;\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   js\cf3 .\cf13 src \cf12 =\cf13  \cf14 "https://connect.facebook.net/fr_FR/sdk.js#xfbml=1&amp;version=v2.9&amp;appId=\{\{ config['FB_APP_ID'] \}\}"\cf3 ;\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   fjs\cf3 .\cf13 parentNode\cf3 .\cf20 insertBefore\cf13 (js\cf3 ,\cf13  fjs)\cf3 ;\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 \}(\cf21 document\cf3 ,\cf13  \cf14 'script'\cf3 ,\cf13  \cf14 'facebook-jssdk'\cf13 ))\cf3 ;\cf13 \
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Si vous rafra\'eechissez la page, vous voyez maintenant appara\'eetre le bouton 'Continuer avec Facebook' en bas de la page. Bravo !\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 H\'e9ritage
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Passons maintenant \'e0 la page de r\'e9sultats\'a0
\f3 \cb8 result.html
\f0 \cb3 . D\'e9finissez une nouvelle vue :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 @app.route(\cf14 '/result/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  result():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf12 return\cf13  render_template(\cf14 'result.html'\cf13 )\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 En ouvrant \'a0\'a0
\f3 \cb8 result.html
\f0 \cb3 , vous\'a0remarquez ais\'e9ment qu'une partie du code se r\'e9p\'e8te. Par exemple, les appels \'e0 l'API de Facebook. Vous\'a0avez mis \'e0 jour l'identifiant Facebook de l'
\f3 \cb8 index.html
\f0 \cb3 \'a0mais vous devriez \'e9galement en faire de m\'eame ici !\'a0\cb1 \
\cb3 Mais que nenni, mon bon ami ! Jinja 2 nous permet de cr\'e9er un template que l'on pourra \'e9tendre \'e0 volont\'e9.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb9 \'c9tendre ? Tu veux dire, comme du linge ?\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Je ne r\'e9agirai pas \'e0 cet essai de blague. Non, \'e9tendre comme une classe enfant qui h\'e9riterait d'une classe parent : vous pouvez changer les valeurs par d\'e9faut du template parent. C'est assez simple\'a0!\cb1 \
\cb3 Cr\'e9ez un template\'a0
\f3 \cb8 base.html
\f0 \cb3 \'a0qui contiendra le squelette de toutes nos pages :\'a0
\f3 \cb8 head
\f0 \cb3 ,\'a0
\f3 \cb8 footer
\f0 \cb3 ...\cb1 \
\pard\pardeftab720\partightenfactor0

\f3 \cf0 \cb8 index.html
\f0 \cb3 \'a0contiendra alors ce qui sera amen\'e9 \'e0 changer dans le template d'origine : le contenu du body.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Pour des raisons de clart\'e9, j'ai d\'e9plac\'e9 le code sur GitHub. Retrouvez-le aux adresses suivantes :\'a0\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls19\ilvl0\cf7 \cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}{\field{\*\fldinst{HYPERLINK "https://github.com/oc-courses/concevez_un_site_avec_flask/blob/P1C4_inheritance/fbapp/templates/base.html"}}{\fldrslt \expnd0\expndtw0\kerning0
\ul base.html}}\cf0 \cb1 \expnd0\expndtw0\kerning0
\
\ls19\ilvl0\cf7 \cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}{\field{\*\fldinst{HYPERLINK "https://github.com/oc-courses/concevez_un_site_avec_flask/blob/P1C4_inheritance/fbapp/templates/index.html"}}{\fldrslt \expnd0\expndtw0\kerning0
\ul index.html}}\cf0 \cb1 \expnd0\expndtw0\kerning0
\
\ls19\ilvl0\cf7 \cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}{\field{\*\fldinst{HYPERLINK "https://github.com/oc-courses/concevez_un_site_avec_flask/blob/P1C4_inheritance/fbapp/templates/result.html"}}{\fldrslt \expnd0\expndtw0\kerning0
\ul result.html}}\cf0 \cb1 \expnd0\expndtw0\kerning0
\
\pard\pardeftab720\partightenfactor0
\cf0 {{\NeXTGraphic 14994462739883_Capture d‚ÄôeÃÅcran 2017-07-07 aÃÄ 18.53.51.png \width31140 \height18840 \noorient
}¨}\pard\pardeftab720\partightenfactor0
\cf0 \
\cb3 Indiquez \'e0 pr\'e9sent\'a0que vous souhaitez\'a0
\b \'e9tendre\'a0
\f3\b0 \cb8 base.html
\f0 \cb3 \'a0dans le\'a0template\'a0
\f3 \cb8 result.html
\f0 \cb3 . Vous pouvez faire\'a0cela en utilisant le mot-cl\'e9\'a0
\f3 \cb8 extends 'nomdutemplate.html'
\f0 \cb3 \'a0:\cb1 \
\cb3 result.html\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 \{% extends 'base.html' %\}\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Si vous rechargez la page, vous verrez que le contenu du template\'a0
\f3 \cb8 base.html
\f0 \cb3 \'a0s'affiche... mais pas celui de\'a0
\f3 \cb8 result.html
\f0 \cb3 . Pourtant il y a bien du contenu dans ce dernier !\cb1 \
\cb3 Vous vous en doutez, c'est normal... Le template parent agit un peu comme un texte \'e0 trou : vous devez indiquer les endroits qui seront amen\'e9s \'e0 changer.\cb1 \
\cb3 Utilisez le mot-cl\'e9\'a0
\f3 \cb8 block nomdemonblock
\f0 \cb3 \'a0comme ceci :\cb1 \
\cb3 base.html\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13   ...\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf3 </\cf12 nav\cf3 >\cf13 \
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 \{% block content %\}\{% endblock %\}\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf3 <\cf12 footer\cf13  \cf21 class\cf12 =\cf14 "text-center"\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   ...\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Jinja 2 sait maintenant que du contenu peut \'eatre ins\'e9r\'e9 \'e0 cet endroit.\cb1 \
\cb3 Dans le template enfant,\'a0
\f3 \cb8 result.html
\f0 \cb3 , englobez le contenu \'e0 envoyer dans le m\'eame bloc :\cb1 \
\cb3 result.html\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 \{% block content %\}\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf19 <!-- Header -->\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf3 <\cf12 header\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     ...\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf3 </\cf12 script\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 \{% endblock %\}\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb15 Vous pouvez cr\'e9er autant de blocs que vous le voulez ! Il vous suffit de changer le nom du bloc.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Je vous laisse en faire de m\'eame pour le template\'a0
\f3 \cb8 index.html
\f0 \cb3 \'a0!\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Passer des variables au template
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Notre page de r\'e9sultats est bien jolie mais il est grand temps de la rendre dynamique ! Autrement dit, de pouvoir changer les \'e9l\'e9ments suivants en fonction de l'utilisateur :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls20\ilvl0\cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
pr\'e9nom\cb1 \
\ls20\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
photo de profil\cb1 \
\ls20\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
description\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 La m\'e9thode\'a0
\f3 \cb8 render_template()
\f0 \cb3 , que nous utilisons dans la vue, est un peu sp\'e9ciale. Vous pouvez\'a0lui donner en param\'e8tres toutes les variables que vous\'a0souhaitez utiliser dans le template. Par exemple, le pr\'e9nom :\cb1 \
\cb3 views.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 @app.route(\cf14 '/result/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  result():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf12 return\cf13  render_template(\cf14 'result.html'\cf13 ,\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13                            user_name\cf12 =\cf14 "Tom"\cf13 )\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 result.html\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf3 <\cf12 h2\cf13  \cf21 id\cf12 =\cf14 "user_name"\cf3 >\cf13 \{\{ user_name \}\}\cf3 </\cf12 h2\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Continuez\'a0ainsi en rempla\'e7ant la photo de profil et la description :\cb1 \
\cb3 views.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 @app.route(\cf14 '/result/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  result():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   description \cf12 =\cf13  \cf14 """\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf14   Toi, tu n'as pas peur d'\'eatre seul ! Les grands espaces et les aventures sont faits pour toi. D'ailleurs, Koh Lanta est ton \'e9mission pr\'e9f\'e9r\'e9e ! Bient\'f4t tu partiras les cheveux au vent sur ton radeau. Tu es aussi un id\'e9aliste chevronn\'e9. Quelle chance !\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf14   """\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf12 return\cf13  render_template(\cf14 'result.html'\cf13 ,\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13                           user_name\cf12 =\cf14 'Tom'\cf13 ,\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13                           user_image\cf12 =\cf13 url_for(\cf14 'static'\cf13 , filename\cf12 =\cf14 'tmp/cover_111823112767411.jpg'\cf13 ),\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13                           description\cf12 =\cf13 description)\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 result.html\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf3 <\cf12 div\cf13  \cf21 class\cf12 =\cf14 "col-sm-3 col-sm-offset-3"\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf3 <\cf12 img\cf13  \cf21 class\cf12 =\cf14 "img-responsive img-circle user_profile"\cf13  \cf21 src\cf12 =\cf14 "\{\{ user_image \}\}"\cf13  \cf21 id\cf12 =\cf14 "user_image"\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf3 </\cf12 div\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf3 <\cf12 div\cf13  \cf21 class\cf12 =\cf14 "col-sm-3"\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf3 <\cf12 h2\cf13  \cf21 id\cf12 =\cf14 "user_name"\cf3 >\cf13 \{\{ user_name \}\}\cf3 </\cf12 h2\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf3 </\cf12 div\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf3 <\cf12 div\cf13  \cf21 class\cf12 =\cf14 "col-sm-12"\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf3 <\cf12 p\cf13  \cf21 id\cf12 =\cf14 "description"\cf3 >\cf13 \{\{ description \}\}\cf3 </\cf12 p\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf3 </\cf12 div\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Faites-en de m\'eame pour la vue\'a0
\f3 \cb8 index
\f0 \cb3 .\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Import de template
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Vous touchez\'a0presque au but !\cb1 \
\cb3 Avant de passer au prochain chapitre,\'a0refactorisez un peu les templates. Vous ne trouvez pas qu'une partie du template se r\'e9p\'e8te ?\cb1 \
\cb3 Cette partie est exactement la m\'eame entre\'a0
\f3 \cb8 index.html
\f0 \cb3 \'a0et\'a0
\f3 \cb8 result.html
\f0 \cb3 \'a0d\'e9sormais :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf3 <\cf12 div\cf13  \cf21 class\cf12 =\cf14 "card"\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf3 <\cf12 div\cf13  \cf21 class\cf12 =\cf14 "row"\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf3 <\cf12 div\cf13  \cf21 class\cf12 =\cf14 "col-sm-3 col-sm-offset-3"\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13         \cf3 <\cf12 img\cf13  \cf21 class\cf12 =\cf14 "img-responsive img-circle user_profile"\cf13  \cf21 src\cf12 =\cf14 "\{\{ user_image \}\}"\cf13  \cf21 id\cf12 =\cf14 "user_image"\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf3 </\cf12 div\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf3 <\cf12 div\cf13  \cf21 class\cf12 =\cf14 "col-sm-3"\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13       \cf3 <\cf12 h2\cf13  \cf21 id\cf12 =\cf14 "user_name"\cf3 >\cf13 \{\{ user_name \}\}\cf3 </\cf12 h2\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf3 </\cf12 div\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf3 <\cf12 div\cf13  \cf21 class\cf12 =\cf14 "col-sm-12"\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13       \cf3 <\cf12 p\cf13  \cf21 id\cf12 =\cf14 "description"\cf3 >\cf13 \{\{ description \}\}\cf3 </\cf12 p\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf3 </\cf12 div\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \cf3 </\cf12 div\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf3 </\cf12 div\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 La seule diff\'e9rence est la classe\'a0
\f3 \cb8 blur
\f0 \cb3 , pr\'e9sente dans l'index et non dans la page de r\'e9sultats.\cb1 \
\cb3 Je vous propose de passer la valeur de\'a0
\f3 \cb8 blur
\f0 \cb3 \'a0dans la vue et de cr\'e9er une structure conditionnelle dans le template :\cb1 \
\cb3 views.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 @app.route(\cf14 '/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 @app.route(\cf14 '/index/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  index():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     ...\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf12 return\cf13  render_template(\cf14 'index.html'\cf13 ,\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13                             user_name\cf12 =\cf14 'Julio'\cf13 ,\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13                             user_image\cf12 =\cf13 url_for(\cf14 'static'\cf13 , filename\cf12 =\cf14 'img/profile.png'\cf13 ),\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13                             description\cf12 =\cf13 description,\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13                             blur\cf12 =\cf18 True\cf13 )\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 result.html et index.html\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf3 <\cf12 p\cf13  \cf21 id\cf12 =\cf14 "description"\cf13  \{% \cf21 if\cf13  \cf21 blur:\cf13  %\}\cf21 class\cf12 =\cf14 "blur"\cf13 \{% \cf21 endif\cf13  %\}\cf3 >\cf13 \{\{ description \}\}\cf3 </\cf12 p\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Cr\'e9ez un nouveau template,\'a0
\f3 \cb8 card.html
\f0 \cb3 , dans lequel vous collerez\'a0la portion de code qui se r\'e9p\'e8te. Puis incluez-le dans\'a0
\f3 \cb8 result.html
\f0 \cb3 \'a0et\'a0
\f3 \cb8 index.html
\f0 \cb3 \'a0en utilisant la m\'e9thode\'a0
\f3 \cb8 include
\f0 \cb3 .\cb1 \
\cb3 index.html et result.html\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf3 <\cf12 div\cf13  \cf21 class\cf12 =\cf14 "col-lg-6 col-lg-offset-3"\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   \{% include 'card.html' %\}\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf3 </\cf12 div\cf3 >\cf13 \
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Rechargez les pages et admirez le travail !\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Code du chapitre
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Retrouvez le code de ce chapitre {\field{\*\fldinst{HYPERLINK "https://github.com/oc-courses/concevez_un_site_avec_flask/tree/P2C1"}}{\fldrslt \cf7 \ul \'e0 cette adresse}}.\
\
\
\
\pard\pardeftab720\partightenfactor0

\b\fs52 \cf2 \cb3 Cr\'e9ez une page de r\'e9sultat gr\'e2ce aux URL dynamiques\cb1 \
\pard\pardeftab720\partightenfactor0

\f1\b0\fs20 \cf3 \
\
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb4 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\qc\partightenfactor0
\cf3 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb5 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb6 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb1 \
\pard\pardeftab720\partightenfactor0

\f2 \cf3 \cb3 06:55
\f1 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb6 \
\pard\pardeftab720\partightenfactor0
\cf3 \cb5 \
\
\
\
\pard\pardeftab720\qc\partightenfactor0
\cf0 \cb1 \
\
\
\pard\pardeftab720\partightenfactor0
\cf3 \
\
\pard\pardeftab720\qr\partightenfactor0

\f0\fs26 \cf7 \cb3 \ul \ulc7 T\'e9l\'e9charger la vid\'e9o\cf0 \cb1 \ulnone \
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 \'a0\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Dans ce chapitre vous d\'e9couvrirez les notions suivantes :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls21\ilvl0\cf0 \cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Comprendre\'a0les param\'e8tres dans une\'a0URL\cb1 \
\ls21\ilvl0\cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
R\'e9cup\'e9rer\'a0des param\'e8tres d'une url dans une vue.\cb1 \
\ls21\ilvl0\cb15 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Chercher des informations\'a0dans la\'a0base de donn\'e9es.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Notre page de r\'e9sultats est assez avanc\'e9e ! Mais il manque deux aspects essentiels :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls22\ilvl0\cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
r\'e9cup\'e9rer les informations de l'utilisateur\cb1 \
\ls22\ilvl0\cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
chercher la description lui correspondant.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Nous pourrions aller assez loin dans l'analyse du profil d'un utilisateur. En soi, Facebook permet d'acc\'e9der \'e0 toutes les informations d'un profil si l'utilisateur donne son accord : adresse e-mail, amis, pages aim\'e9es...\cb1 \
\cb3 Pour ce cours, faisons\'a0simple : trouvons\'a0une description au hasard mais adapt\'e9e au genre de la personne.\cb1 \
\cb3 Vous devez par cons\'e9quent r\'e9cup\'e9rer les informations suivantes :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls23\ilvl0
\b \cf0 \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Pr\'e9nom
\b0 , pour personnaliser la page de r\'e9sultats,\cb1 \
\ls23\ilvl0
\b \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Identifiant
\b0  de son profil, pour g\'e9n\'e9rer une image de profil,\cb1 \
\ls23\ilvl0
\b \cb3 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
Genre
\b0 , pour filtrer les descriptions correspondantes.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 URL dynamique
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Avant de voir comment r\'e9cup\'e9rer ces informations de la part de Facebook, int\'e9ressez-vous \'e0 la page de r\'e9sultats. Vous allez passer ces informations en param\'e8tres de l'url. Par exemple :\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 localhost:5000/result?first_name=C\'e9line&id=1933433063608371&gender=female\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 D\'e9composons cette url :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls24\ilvl0
\f3 \cf0 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
localhost:5000
\f0 \cb3 \'a0: {\field{\*\fldinst{HYPERLINK "https://fr.wikipedia.org/wiki/Nom_de_domaine"}}{\fldrslt \cf7 \ul nom de domaine}} et port utilis\'e9.\cb1 \
\ls24\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
/result
\f0 \cb3 \'a0: sch\'e9ma utilis\'e9 pour identifier la route.\cb1 \
\ls24\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
?
\f0 \cb3 \'a0: s\'e9parateur entre le sch\'e9ma et les param\'e8tres.\cb1 \
\ls24\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
first_name=C\'e9line
\f0 \cb3 \'a0: association entre le nom du param\'e8tre (
\f3 \cb8 first_name
\f0 \cb3 ) et sa valeur (
\f3 \cb8 C\'e9line
\f0 \cb3 ).\cb1 \
\ls24\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
&
\f0 \cb3 \'a0: s\'e9parateur entre chaque param\'e8tre.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 C'est ce que nous appelons une 
\b URL\'a0dynamique
\b0  car les valeurs des param\'e8tres sont amen\'e9es \'e0 varier.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Pour en savoir plus sur la composition d'une URL, lisez {\field{\*\fldinst{HYPERLINK "https://fr.wikipedia.org/wiki/Uniform_Resource_Locator"}}{\fldrslt \cf7 \ul cet article de Wikipedia}}.\'a0\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 R\'e9cup\'e9rer les param\'e8tres d'une URL dynamique
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\b\fs36 \cf0 \cb3 Param\'e8tres optionnels\cb1 \
\pard\pardeftab720\partightenfactor0

\b0 \cf0 \cb3 Flask contient l'objet\'a0
\f3 \cb8 request
\f0 \cb3 \'a0qui repr\'e9sente la requ\'eate ex\'e9cut\'e9e par le client.\cb1 \
\cb3 Il contient de nombreux param\'e8tres int\'e9ressants :\cb1 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\partightenfactor0
\ls25\ilvl0
\f3 \cf0 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
request.path
\f0 \cb3 \'a0renvoie la route demand\'e9e\cb1 \
\ls25\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
request.method
\f0 \cb3 \'a0renvoie la m\'e9thode HTTP utilis\'e9e\cb1 \
\ls25\ilvl0
\f3 \cb8 \kerning1\expnd0\expndtw0 {\listtext	\'95	}\expnd0\expndtw0\kerning0
request.args
\f0 \cb3 \'a0renvoie un dictionnaire contenant les param\'e8tres pr\'e9sents dans l'URL.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Utilisez ce dernier dans la\'a0vue.\cb1 \
\cb3 views.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  flask \cf12 import\cf13  Flask, render_template, url_for, request\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 @app.route(\cf14 '/result/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  result():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     description \cf12 =\cf13  \cf14 """\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf14     Toi, tu n'as pas peur d'\'eatre seul ! Les grands espaces et les aventures sont faits pour toi. D'ailleurs, Koh Lanta est ton \'e9mission pr\'e9f\'e9r\'e9e ! Bient\'f4t tu partiras les cheveux au vent sur ton radeau. Tu es aussi un id\'e9aliste chevronn\'e9. Quelle chance !\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf14     """\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     gender \cf12 =\cf13  request.args.get(\cf14 'gender'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     user_name \cf12 =\cf13  request.args.get(\cf14 'first_name'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     uid \cf12 =\cf13  request.args.get(\cf14 'id'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     profile_pic \cf12 =\cf13  \cf14 'http://graph.facebook.com/'\cf13  \cf12 +\cf13  uid \cf12 +\cf13  \cf14 '/picture?type=large'\cf13 \
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf12 return\cf13  render_template(\cf14 'result.html'\cf13 ,\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13                             user_name\cf12 =\cf13 user_name,\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13                             user_image\cf12 =\cf13 profile_pic,\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13                             description\cf12 =\cf13 description)\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Naviguez sur l'url\cb1 \
\pard\pardeftab720\partightenfactor0

\f3 \cf0 \cb8 localhost:5000/result?first_name=C\'e9line&id=1933433063608371&gender=female
\f0 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Ca fonctionne !\cb1 \
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "http://flask.pocoo.org/docs/0.12/quickstart/#the-request-object"}}{\fldrslt \cf7 \cb3 \ul En savoir plus dans la documentation officielle de Flask}}\
\pard\pardeftab720\partightenfactor0
\cf0 \cb9 Je ne comprends pas bien comment tu g\'e9n\'e8res l'image de profil.\cb1 \
\cb9 Les photos de profil de tous les utilisateurs de Facebook sont publiques. Il est possible de les voir en plusieurs formats \'e0 choisir directement dans l'URL. {\field{\*\fldinst{HYPERLINK "https://developers.facebook.com/docs/graph-api/reference/profile-picture-source/"}}{\fldrslt \cf7 \ul Lire la documentation sur Facebook}}.\cb1 \
\pard\pardeftab720\partightenfactor0

\b \cf0 \cb3 Param\'e8tres obligatoires\cb1 \
\pard\pardeftab720\partightenfactor0

\b0 \cf0 \cb3 Vous souvenez-vous de l'architecture REST ? Si vous avez lu le cours de Sarah, vous savez que l'URL d'une ressource peut ressembler \'e0 celle-ci :\'a0
\f3 \cb8 /contents/1
\f0 \cb3 .\cb1 \
\cb3 Mais comment acc\'e9der \'e0 la partie variable ? Nous n'avons ici pas de point d'interrogation en guise de s\'e9parateur.\cb1 \
\cb3 L'op\'e9ration va \'eatre l\'e9g\'e8rement diff\'e9rente. Plut\'f4t que de faire appel \'e0 l'objet\'a0
\f3 \cb8 request
\f0 \cb3 , vous allez modifier directement la route impact\'e9e :\cb1 \
\cb3 views.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 @app.route(\cf14 '/contents/<content_id>/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  content(content_id):\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf12 return\cf13  \cf14 '%s'\cf13  \cf12 %\cf13  content_id\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Indiquez les parties sp\'e9ciales d'une url en ajoutant\'a0
\f3 \cb8 <variable>
\f0 \cb3 . Cette partie est alors pass\'e9e en tant qu'argument de la vue.\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb15 Vous pouvez sp\'e9cifier un convertisseur pour forcer l'utilisation d'un type d'objet. Pour convertir une cha\'eene en entier, par exemple, utilisez\'a0
\f3 \cb8 int
\f0 \cb15 . views.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13   @app.route('/contents/<int:content_id>/')\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13   def content(content_id):\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13       return '%s' % content_id\
\pard\pardeftab720\partightenfactor0

\f0\b\fs44 \cf2 \cb3 Chercher dans la base de donn\'e9es les informations ad\'e9quates
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 La derni\'e8re \'e9tape de ce chapitre consiste \'e0 trouver une description au hasard en fonction du genre de l'utilisateur.\cb1 \
\cb3 Commencez par trouver une description au hasard !\cb1 \
\cb3 Cr\'e9ez un nouveau fichier,\'a0
\f3 \cb8 utils.py
\f0 \cb3 , qui contiendra les objets qui ne sont pas li\'e9s \'e0 Flask. Dans le chapitre suivant vous\'a0y ajouterez une nouvelle classe pour g\'e9n\'e9rer une image \'e0 partir d'une description.\cb1 \
\cb3 utils.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf12 import\cf13  random\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  fbapp.models \cf12 import\cf13  Content, Gender\
\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  find_content(gender):\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     contents \cf12 =\cf13  Content.query.\cf20 filter\cf13 (Content.gender \cf12 ==\cf13  Gender[gender]).\cf20 all\cf13 ()\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     \cf12 return\cf13  random.choice(contents)\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb15 La premi\'e8re ligne de la fonction\'a0
\f3 \cb8 find_content()
\f0 \cb15 \'a0peut vous sembler \'e9trange. La m\'e9thode\'a0
\f3 \cb8 filter()
\f0 \cb15 \'a0prend en param\'e8tre le filtre \'e0 appliquer : la colonne de la base de donn\'e9es et la valeur \'e0 y trouver. {\field{\*\fldinst{HYPERLINK "http://flask-sqlalchemy.pocoo.org/2.1/queries/#querying-records"}}{\fldrslt \cf7 \ul Lire la documentation}}\cb1 \
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 Importez le script dans\'a0
\f3 \cb8 views.py
\f0 \cb3 \'a0:\cb1 \
\cb3 views.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 from\cf13  .utils \cf12 import\cf13  find_content\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13 ...\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb3 Dans la vue\'a0
\f3 \cb8 result
\f0 \cb3 , vous\'a0pouvez maintenant trouver une description au hasard en fonction du genre :\cb1 \
\cb3 views.py\cb1 \
\pard\pardeftab720\partightenfactor0

\f5\fs24 \cf10 \cb11 \
\pard\pardeftab720\partightenfactor0
\cf13 @app.route(\cf14 '/result/'\cf13 )\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf12 def\cf13  result():\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     ...\
\pard\pardeftab720\partightenfactor0
\cf10 \
\pard\pardeftab720\partightenfactor0
\cf13     description \cf12 =\cf13  find_content(gender).description\
\pard\pardeftab720\partightenfactor0

\f0\fs36 \cf0 \cb23 Pensez bien \'e0 
\b ajouter des descriptions
\b0  dans la base de donn\'e9es avant de lancer le script ! En effet, si votre base ne contient aucun item correspondant au genre demand\'e9, le programme renverra une erreur.\cb1 \
\pard\pardeftab720\partightenfactor0

\b\fs44 \cf2 \cb3 Code du chapitre
\b0 \cb1 \
\
\pard\pardeftab720\partightenfactor0

\fs36 \cf0 \cb3 Retrouvez le code du chapitre {\field{\*\fldinst{HYPERLINK "https://github.com/oc-courses/concevez_un_site_avec_flask/tree/P2C2"}}{\fldrslt \cf7 \ul \'e0 cette adresse}}.\
\
\
\
\
\pard\pardeftab720\partightenfactor0
\cf0 \cb3 \
\
}